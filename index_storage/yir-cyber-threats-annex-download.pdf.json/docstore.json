{"docstore/data": {"741e6a5b-0e7f-4faa-903a-7a06804f95a2": {"__data__": {"id_": "741e6a5b-0e7f-4faa-903a-7a06804f95a2", "embedding": null, "metadata": {"page_label": "1", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Cyber Threats 2021: \nA Year in Retrospect\nAnnex", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "19df8129-33e6-4812-90e1-2a5e7468dd06": {"__data__": {"id_": "19df8129-33e6-4812-90e1-2a5e7468dd06", "embedding": null, "metadata": {"page_label": "2", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "2  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nContents\n04\nTools, \ntechniques, and \nprocedures 22\nTrends in \nDetection 30\nCVE Spotlight 37\nConclusion\n38\nEndnotes\npwc.com/cyber-security", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "ca0e28c5-eeeb-4c22-993c-f27755980db3": {"__data__": {"id_": "ca0e28c5-eeeb-4c22-993c-f27755980db3", "embedding": null, "metadata": {"page_label": "3", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "3  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nIntroduction\nThis Technical Annex supplements our Cyber Threats \n2021: A Year in Retrospect annual Threat Intelligence \nreport, which examines the overarching and thematic \ncyber threat trends of 2021. \nWith this Technical Annex, we provide more detailed \ninformation about the Tools, Techniques, and Procedures \n(TTPs) that we observed threat actors using throughout 2021, \nas well as of high-profile and high-impact vulnerabilities \ndisclosed during the year, mapping our findings across \nthe MITRE ATT&CK framework for consistency and clarity. \nWe present further intelligence related to these TTPs and \nvulnerabilities, including incident response case studies, to \ngive defenders real-world context. We also share some of \nthe detection engineering logic we applied when faced with \nthreats such as 0-days, and some of the challenges that we \nencountered in the process. Our analysis is based on our \nin-house intelligence datasets on cyber attacks and targeting \nfrom a variety of threat actors, intelligence gleaned from our \nincident response engagements around the world, and our \nmanaged threat hunting services, as well as publicly available \ninformation. \nUltimately, this annex is designed to be actionable for \ndefenders, whether by building out an organisation\u2019s threat \nmodel, or mapping the current state of its defences against \nthe threat landscape, or to implement new detection ideas.\nValid credentials for victim networks, either obtained through \nphishing campaigns or through dark web markets, were \none of the main initial access vectors that we observed in \n2021 across threat actors of all motivations and degrees of \nsophistication. Our research into credential marketplaces \nshowed that they play a key Access-as-a-Service role for \ncriminal actors, with credentials exposed through the simple \nleaking of compromised data, auctions, or private sales to \nindividual buyers. Execution and Evasion remain the most prevalent categories \nthat we observed techniques for at the endpoint level \non victim networks. Execution Flow Hijacking remains a \npopular technique among threat actors to achieve code \nexecution while evading detection; during post-exploitation, \nwe observed threat actors favouring .NET, with PowerShell \nremaining extremely popular but subject to greater scrutiny \nby defenders. Evolutions in Cobalt Strike evasion also \nenable this offensive security tool to persist as a staple in \nmany threat actor arsenals, from cyber criminal groups to \nespionage-motivated advanced persistent threats (APTs).\nThe increased reliance of many businesses on cloud services \nfor day-to-day operations makes them an attractive option \nfor threat actors to evade traditional security controls: where \nan attacker is hosting their malware command and control \non the same cloud service as their victim uses for legitimate \nbusiness, that malware activity will be harder to separate from \nlegitimate activity. Throughout 2021, we continued to observe \nthreat actors abusing legitimate services, such as file storage \nand sharing platforms, or collaboration and communication \ntools, and hiding amid benign activity.\nFinally, along with existing known vulnerabilities, the high \nvolume of 0-day vulnerabilities disclosed in 2021 enabled \nthreat actors of all motivations to perform targeted attacks \nand mass-scale exploitation attempts alike. However, \nalthough vulnerabilities in widespread products such as \nMicrosoft Exchange and Log4j made for a very large attack \nsurface for threat actors to capitalise upon, we found defence \nin depth and security hygiene practices made a tangible \npositive impact in enabling detection and response to \nexploitation attempts.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "31a54b92-50fb-497c-9e16-4a5cd57405b7": {"__data__": {"id_": "31a54b92-50fb-497c-9e16-4a5cd57405b7", "embedding": null, "metadata": {"page_label": "4", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "4  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nTools, techniques, \nand procedures", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "dda01e93-233e-42d6-b0bc-02119e238ab5": {"__data__": {"id_": "dda01e93-233e-42d6-b0bc-02119e238ab5", "embedding": null, "metadata": {"page_label": "5", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "5  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nThe MITRE ATT&CK framework is a matrix that maps attack methodologies to each stage of an intrusion. It allows for a \ncomprehensive and nuanced \u201cstep-by-step\u201d understanding of a threat actor\u2019s tools, techniques, and procedures (TTPs). \nIn this section, we describe the techniques that we have observed being most frequently used in 2021 by threat actors. We \nnote that such observations may vary across different organisations, as each has a unique threat profile and access to unique \ncombinations of data, however, these techniques are some of the many that appear to be consistently used by threat actors of \nall motivations across every region.\nMITRE ATT&CK techniques\nThe following tables highlight the most common techniques we saw used in 2021.\nTechnique Description Explanation\nInitial Access\nT1566.001 Phishing: \nSpearphishing \nAttachmentPhishing remains one of the most pervasive threat vectors we observe throughout \nour analysis, incident response, and security operations work. It is used by threat \nactors of all motivations and can take many forms, whether it be a malicious spam \n(malspam) operation \u2013 wherein threat actors send large volumes of emails with \nmalicious links or attachments, with the purpose of netting as many successful \ninteractions with their payload as possible \u2013 or through more targeted spearphishing \nattacks. In this particular sub-category of the MITRE ATT&CK framework, there is \na focus on a malicious file being appended to the phishing email and requiring the \nuser to interact with it. The email itself will contain a social engineering element: for \nexample some form of encouraging language, a request, an alert conveying a sense \nof urgency, or a proposal seemingly too good to pass up. A characteristic example of \nthis is North Korea-based Black Artemis (aka Lazarus Group)'s continued use of lure \ndocuments themed around job specifications1  for roles at high-profile companies \nin the defence and engineering sectors, which are sent to targets often after the \nthreat actor establishes a rapport by posing as a recruiter on social media such as \nLinkedIn. While spearphishing attachments often tend to be malicious documents or \nexecutables, other threat actors may adopt more complex delivery and installation \nchains. For example, Russia-based Blue Dev 52 would send targets a malicious ISO \nimage attached to an email; the ISO file would contain a LNK file meant to load and \nrun a malicious dynamic link library (DLL) on victim systems.\nT1190 Exploit \nPublic-Facing \nApplicationExternal-facing applications are an attractive target to threat actors of all motivations \nand at varying levels of sophistication. In 2021, we observed large volumes of activity \ntargeting vulnerable external-facing applications, particularly surrounding  releases \nof high-profile, remotely exploitable 0-day vulnerabilities.3,4 Both ProxyLogon and \nLog4Shell, among others, were initially exploited by advanced persistent threats, \nand then quickly adopted for mass scanning5 and exploitation by threat actors \nof all kinds, ranging from ransomware operators to cryptojacking campaigns. We \nobserved China-based and Iran-based threat actors heavily performing mass scans \nfor vulnerabilities in exposed interfaces. Red Djinn6 (aka BlackTech, Mobwork, \nPalmerworm) has been targeting vulnerable routers as well as indiscriminately \nscanning for vulnerable Oracle and VMWare appliances. Yellow Dev 247 (aka \nNemesis Kitten) scanned for and exploited internet facing appliances, including \nFortinet appliances and Microsoft Exchange servers, to then deploy Mimikatz and \nthe FRPC proxying tool.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "4a790494-2857-408c-9cea-2b5ac5040323": {"__data__": {"id_": "4a790494-2857-408c-9cea-2b5ac5040323", "embedding": null, "metadata": {"page_label": "6", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "6  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nExecution\nT1204.002 User Execution: \nMalicious FileThe most commonly observed technique across our analysis this year, the use of \nmalicious files, is likely to remain a staple for threat actors of all motivations as a \ntechnique for initial entry. There is, however, nuance to this technique, as threat \nactors find novel ways to make use of malicious files. We continue to see social \nengineering play an important part in the success of this technique. For example, \nPwC responded to an incident involving a threat actor we track as White Dev 898 \nwhich made use of a trojanised Zoom installer that purported to be legitimate. \nWe also tracked a Blue Dev 5 campaign9 involving phishing emails with malicious \nHTML attachments containing short JavaScript payloads; these would upload at \nleast the User-Agent and external IP address of the victim, as well as the filepath of \nthe attachment, to a Firebase instance controlled by the threat actor to fingerprint \ncompromised machines and identify targets of interest.\nT1204.002 User Execution: \nMalicious FilePowerShell is an incredibly powerful command line tool native to the Windows \nOperating System. This characteristic affords threat actors the opportunity to rely on \na legitimate tool, installed on most systems, to execute malicious commands and \nscripts. PowerShell can be used in a variety of ways throughout multiple phases of \na threat actor\u2019s campaign, and is still widely popular due to its versatility and to the \nsuccess threat actors have found in using it, despite an increase in defenders\u2019 ability \nto detect and block malicious PowerShell execution. For example, White Dev 8510  \nhas been targeting entities in the Middle East with macro-weaponised documents \nthat deliver PowerShell scripts to victims. Black Banshee11 (aka Kimsuky, Velvet \nChollima) has similarly used obfuscated PowerShell commands hidden in malicious \nmacros to download payloads from a remote staging server and execute them.\nFigure 1 - A Black Banshee macro containing lightly-obfuscated PowerShell \nFigure 2 - The same Black Banshee macro containing PowerShell, after deobfuscation\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "4f2613fb-1197-458c-bd7f-516bd4393a23": {"__data__": {"id_": "4f2613fb-1197-458c-bd7f-516bd4393a23", "embedding": null, "metadata": {"page_label": "7", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "7  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nT1059.003 Command \nand Scripting \nInterpreter: \nWindows \nCommand ShellMuch like PowerShell, the Windows Command Line offers threat actors versatility \nin terms of both functionality and defence evasion. Threat actors can make specific \nuse of it to prevent immediate detection: for example by pairing this technique \nwith obfuscation mechanisms or batch files. PwC\u2019s analysis of an open directory \nlikely related to an Iran-based threat actor12 revealed the use of a batch script to \nquery malicious C2 domains in what was likely an attempt to download next stage \npayloads onto the victim\u2019s system. Yellow Liderc13 (aka Tortoiseshell, TA456) has also \nused malicious macros containing over forty hardcoded command-line commands \nto fingerprint a victim\u2019s network ahead of post-exploitation and lateral movement \nactivities. PwC has also observed ransomware operators, such as White Dev 72 \n(aka Babuk)14, using the command line to allow for the malware\u2019s configuration and \nfunctionality to be customised by the affiliate using it.\nT1059.005 Command \nand Scripting \nInterpreter: \nVisual BasicVisual Basic (VB) is primarily used by threat actors during the initial access or \nexecution phase, and is most commonly observed in malicious Microsoft Office \ndocument macros. VB as a language is relatively flexible, and some of its features \nallow anti-analysis and defence evasion via tactics such as VBA stomping. VB \nmacros are prevalent across the threat landscape. A common technique involves \nusing VB scripts to concatenate, decode, and run payloads \u2013 for example, White \nAustaras\u2019s (TA505) MirrorBlast15 campaign exploited VB\u2019s capabilities in Excel \ndocuments to concatenate and execute the content of several cells, which would \nultimately form a one-line JavaScript downloader for further payloads. Black \nAlicanto16 (aka Dangerous Password, LeeryTurtle, CryptoMimic, CryptoCore, \nOperation SnatchCrypto) has also been using a series of subsequent VBScript \nbackdoors collectively known as CageyChameleon and CabbageRAT.\n))\u201dwith)new ActiveXObject)\u201dWindowsInstaller.Installer\n})\u201d246].[185.225.19 //:InstallProduct)\u201dhxxp ;2=UILevel{Figure 3 - White Austaras\u2019 MirrorBlast malicious documents contain macros that concatenates cells, and then \nexecutes their contents - a JavaScript which has been reversed with each word split using a *** string.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "771a26b7-2fda-4235-b013-19fa89de2eb5": {"__data__": {"id_": "771a26b7-2fda-4235-b013-19fa89de2eb5", "embedding": null, "metadata": {"page_label": "8", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "8  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nT1204.001 User Execution: \nMalicious LinkIt is not just malicious files that threat actors relied on in 2021, but malicious links \nas well. This technique is in many ways a response to the spotlight put on malicious \ndocuments by security researchers, with several threat actors having success with \ndomain spoofing leading to the victim downloading a malicious payload via the link. \nThis technique makes it relatively easy to create a malicious domain that appears \nlegitimate to the user through the use of domain spoofing or mirroring technique (i.e, \nmicr0soft[.]com, or mail-mailbox-microsoft[.]com). These domains can be used to \nhost the payload intended for the victim that may otherwise have been deemed as \nsuspicious when merely attached to an email. Just as with malicious attachments, \nthe use of malicious links often involves a measure of social engineering by the \nthreat actor to persuade victims into opening the link. Ransomware operators have \nbeen known to employ this technique in emails, including White Khione (aka Luna \nSpider, GOLD SWATHMORE) during its IcedID campaigns.17 In April 2021, IcedID \nemails sent to victims contained a URL leading to a Google site and prompting the \nuser to visit it in order to view allegedly stolen photographs. The link led to a  ZIP \narchive download, which contained a JavaScript file designed to download and \nexecute IcedID.\nPersistence\nT1547.001 Boot or Logon \nAutostart \nExecution: \nRegistry Run \nKeys / Startup \nFolderBoth espionage and criminally motivated threat actors have the need to remain \npersistent on a victim\u2019s system, in order to ensure that their campaigns are not \nterminated by the victim turning off their machine, or even removing the malware\u2019s \nrunning instance. The use of Run Registry Keys or the Startup Folder allows a threat \nactor to both hide and house their malware in a place on disk (be it a Registry Key \nor folder), such that the malware would always run when the machine starts up or \nthe user logs in. This technique is common, likely due to the ease of implementation, \nwith threat actors not having to rely on the writing of extra code or scripts for \neffective persistence. However, despite its prominence, one novel use of this \ntechnique PwC\u2019s threat intelligence team observed was by Iran-based threat actor \nYellow Nix18 (aka Static Kitten, MERCURY , MuddyWater) which, through the use of \nseveral scripts, loaded further malicious scripts that would only run once the victim \nhad restarted their system, and not before.\nPrivilege \nEscalation\nT1053.005 Scheduled Task/\nJob: Scheduled \nTaskAmong the many ways for threat actors to achieve persistence on a victim\u2019s system, \nscheduled tasks remain very common. These can be implemented through a \nvariety of methods, such as the schtask command line, or through a call to a native \nWindows API function. Scheduled tasks are also configurable, providing threat \nactors flexibility in choosing the conditions of their malware\u2019s permanence on victim \nsystems. However, another use of this technique was observed by a threat actor \nPwC tracks as Red Dev 1419, which used scheduled tasks alongside executables, \nusing the scheduled task\u2019s functionality as a way to execute the binaries. This is a \nnon-standard use of this technique, which is usually only used for persistence once \nthe malware has been executed.\nIt is likely that Red Dev 14 injected code into AppLaunch.exe files that enabled it to gain persistence via a service under\n .Services\\MicrosoftFrameworkLaunchUtility \\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\nThe threat actor also set up the following scheduled task set to run at the system\u2019s startup:\n schtasks /create /tn Microsoft\\Windows\\Wmi /tr \u201dcmd /c \\\u201dstart rundll32  \n\u201d\u201d C:\\Windows\\WmiAd.dll,func\\\u201d\u201d /sc onstart /ru\nThe WmiAd.dll file was a malicious DLL based on the codebase of a backdoor named FUNRUN in open source. ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "74690be7-c35e-4f22-ba9f-eb3a4138a01a": {"__data__": {"id_": "74690be7-c35e-4f22-ba9f-eb3a4138a01a", "embedding": null, "metadata": {"page_label": "9", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "9  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nDefence Evasion\nT1221 Template \nInjectionThreat actors have been known to abuse Microsoft Office document\u2019s remote \ntemplates functionality by embedding URL links to their own infrastructure, allowing \nfor a malicious payload to be fetched and executed while a document displays to \nthe user. While this is not a new technique, we continued to observe several threat \nactors relying on it throughout 2021. It is frequently employed by Russia-based \nthreat actor Blue Odin20 (aka CloudAtlas), which was observed in 2021 making use of \na spoofed COVID-19 form purporting to be from a Western government, containing \ntwo embedded remote UNC paths to a remote C2 server. This same technique \nwas also used by Blue Odin to target victims in post-Soviet states through spoofed \nofficial-looking documents, but heavily guarding its payloads to prevent researchers \nfrom observing follow-on infection stages. Blue Otso21 is also known for its heavy \nuse of malicious documents involving template injection. Russia-based threat \nactors are not the only ones adopting this technique, however, for example, North \nKorea-based Black Dev 222 (aka Operation Gold Hunting, Operation SnatchCrypto) \nhas consistently used Office documents fetching a remote template with malicious \nmacros in its targeting of cryptocurrency businesses and venture capital firms.\nT1027 Obfuscated Files \nor InformationThere are multiple reasons why a threat actor may choose to encode or encrypt their \nmalware, but most of these reasons centre around protecting their payload from \nbeing discovered and analysed. One of the most sophisticated code obfuscations \nthat we observed this year was implemented by China-based threat actor Red \nDev 10 (aka Earth Lusca), which created a bespoke packing mechanism for its \nShadowPad payloads. We call this mechanism Scatterbee23, and have covered it in \nmore detail in a public blog.24 For example in 2021, we also observed activity with \ntentative links to Scarlet Ioke (a.k.a Ocean Lotus, APT32) involving Shikata Ga Nai-\nencoded CobaltStrike payloads.25\nT1036 Masquerading Masquerading is a common technique often used by threat actors to blend into \nthe victim\u2019s environment and mimic legitimate activity. This can be implemented \nin multiple ways; for example, we observed Android malware attributed to Grey \nKarkadann (aka Arid Viper, APT-C-23) with the ability to mimic legitimate Google \napplications once installed.26 It not only had the ability to mimic these in name and \nicon, but also opened the legitimate application for the victim when requested.\nT1070.004 Indicator \nRemoval on \nHost: File \nDeletionA common method of defence evasion that PwC has observed being used by \nmultiple threat-actors in 2021 is performing file deletion on compromised systems \nin order to remove forensic artefacts. This could involve files that were used during \nthe initial access or post-exploitation phases, or files staged and subsequently \nexfiltrated to a threat actor-controlled server. Some Black Artemis macros would \ninitially decode multiple malicious payloads and drop them into a victim\u2019s %TEMP% \nfolder, before executing them and deleting the evidence of their initial installation and \npresence on disk. PwC\u2019s research into ObliqueRAT27 this year also evidenced how \nPakistan-based Green Havildar (aka APT36, Transparent Tribe, Gorgon Group) was \nusing the File Deletion technique to delete traces of file exfiltration, as the malware \nhad the capability to upload a compressed archive file to the C2, and subsequently \ndelete it.\nT1112 Modify Registry The Registry hive offers multiple opportunities to threat actors: from evading \ndefences, to achieving privilege escalation, persistence, execution, and information \ndiscovery. Ransomware operator White Apep provided Darkside & BlackMatter \npayloads to whom?28 with a known UAC bypass technique that involved modifying \nthe Registry. This would then allow the malware to execute with higher privileges. \nWhile this is by no means a new technique, certain malware families also continue \nto check for specific registry keys in order to avoid executing in a virtual machine; \nin 2021, for example, we observed Black Banshee\u2019s BravePrince29 checking for \nVMWare registry keys before continuing execution.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "8161e78f-255a-4955-b567-bb228bdd2b1d": {"__data__": {"id_": "8161e78f-255a-4955-b567-bb228bdd2b1d", "embedding": null, "metadata": {"page_label": "10", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "10  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nDiscovery\nT1083 File and \nDirectory \nDiscoveryThis technique is leveraged by a vast majority of malware, with varying use cases. \nRansomware, for example, will look to discover files and directories as part of its \nencryption functionality, but also potentially as part of its discovery phase for future \nexfiltration. We observed an affiliate of the BlackMatter operation30 doing exactly \nthis during an incident response case, moving laterally through the victim\u2019s network \nmarking sensitive files for exfiltration at a later phase. Ransomware has also often \nlooked for files to be excluded during its encryption process; our reporting on Grief31 \nransomware shows several specific file extensions that will be skipped over when \nencrypting the system in order to maintain enough functionality for the victim to \nnavigate to the threat actor\u2019s leak site. Malware deployed by espionage-motivated \nthreat actors has typically used this technique for information collection purposes, \nsuch as Orange Athos\u2019s (aka Patchwork) BADNEWS backdoor.32 But threat actors \nmay also decide to specifically try and identify files of interest: for example, Black \nBanshee\u2019s BravePrince RAT33 would check a victim\u2019s Recent folder for any .lnk, Word \n(.doc and .docx), or Hangul Word Processor (HWP) files and copy them to a staging \nfolder ahead of exfiltration.\nT1057 Process \nDiscoveryThreat actors can have multiple uses for querying the running processes on a \nsystem, such as an anti-analysis conditional check on the existence of specific \nprocesses (such as checking for a specific security research analysis tool), or as \na malware persistence check to ensure the currently running implant is the only \ninstance of itself running on the victim system. PwC observed activity that we assess \nwith realistic probability to be related to Vietnam-based Scarlet Ioke that made use \nof this technique34, querying all processes and threads to ensure the malware was \nthe only instance of itself running.\nT1033 System Owner/\nUser DiscoveryThreat actors frequently attempt to identify a system\u2019s owner or user, sometimes \nfor victim fingerprinting, often for the purposes of eventual privilege escalation or \nlateral movement. There are multiple avenues for gleaning this information, such \nas native APIs, legitimate operating system command line functionality, and certain \nenvironment variables (e.g., querying %USERNAME%). This technique can also be \nused for anti-analysis purposes and as an execution guardrail: an example of this \nusage includes the campaigns of China-based threat actor Red Kelpie35 (aka APT41), \nwhose Motnug loader made use of a specific flag that could ensure the infected \nvictim was running with system privileges, and stop executing otherwise.\nT1082 System \nInformation \nDiscoveryMost malware performs system information discovery, though the purposes may \nvary. In the majority of cases, system information is collected as part of the victim \nfingerprinting and Discovery stage of an intrusion. It is also information that can \nbe used by the threat actor for further payload deployment (for example after \ndiscovering the version of Windows that is running on the machine). PwC observed \nIran-based Yellow Liderc36 using this technique extensively during the initial attack \nphase, running an extensive list of commands to obtain information about the \nvictim\u2019s system, network, and users. This was likely done to determine the victim\u2019s \nsuitability for further exploitation. Threat actors may also use malicious scripts to \nprofile victim systems: for example, Black Alicanto\u2019s third-stage VBScript payload \nknown as Cabbage RAT-C gathers extensive data about the victim host, from basic \nsystem information to network configuration, and even running processes and their \ncommand line data.37", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "47c34c78-9412-47ab-b400-8c8278c2b0a7": {"__data__": {"id_": "47c34c78-9412-47ab-b400-8c8278c2b0a7", "embedding": null, "metadata": {"page_label": "11", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "11  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nCollection\nT1074.001 Data Staged: \nLocal Data \nStagingNot all threat actors might stage data locally on the victim machine ahead of exfiltration. \nIn some cases, the threat actor might configure a backdoor or script to automatically \nupload files of interest to the C2, or avoid this kind of technique in order to minimise \nthe risk of getting identified. From a detection and hunting perspective, the specific file \npath and filenames patterns that a threat actor might use when staging data can be \na useful data point when searching a device or network for evidence of exfiltration, or \neven to find more malware samples that exhibit similar behaviour when staging collected \ndata. For example, the updated version of the Black Banshee implant BravePrince38 \ncontained a module with the functionality to stage victim files in a custom folder within \nthe victim's %APPDATA% directory, which would later be compressed, encrypted, and \nthen exfiltrated by the backdoor over email. Similarly, Red Menshen\u2019s C++ information-\ngathering tool GetInfo39 would also stage data locally, for later exfiltration by the implant \nthat had deployed GetInfo to start with. \nT1113 Screen Capture Screen capture is usually a function within a backdoor, allowing for live image capture \nof a victim's screen, and usually done on a timed basis. \u2018PwC has observed this \nfunctionality typically used as part of a wider toolset within espionage-motivated arsenals. \nCotXRat malware, also known as KeyBoy, has these capabilities, as the threat actor \nis able to grab a screen capture of the victim's machine through a numeric command \ncode.40 ShadowPad malware also includes modules dedicated to screen capture, though \nnot all threat actors with access to the backdoor may choose to use them. Finally, Red \nMenshen\u2019s GetInfo41 also has the ability to take screenshots and capture video from \nvictims' webcam.\nCommand and \nControl\nT1071.001 Application \nLayer Protocol: \nWeb ProtocolsThe majority of the networking protocols PwC observed being used by threat actors and \nmalware during 2021 were made up of HTTP (over port 80) or HTTPs (over port 443). \nWe assess this is highly likely due to the ease with which malware can be configured \nto these protocols, as well as the fact that the malicious traffic is more likely to blend in \nwith benign network activity. Most malware that we observed in 2021 uses this technique \nfor its command and control (C2) configuration, such as China-based threat actor Red \nDjinn's FlagPro and SpiderRAT malware; or Black Artemis's  PaintJob malware 42 Slightly \nmore sophisticated uses of HTTP or HTTPS involve the usage of APIs; for example, \nwe saw Black Shoggoth's (aka APT37, Reaper) BlueLight payload ROKRAT43 using the \nMicrosoft Graph API for C2.\nT1132.001 Data Encoding: \nStandard \nEncodingWhen exfiltrating information from a victim system, or downloading data to it, threat \nactors will often look to perform some form of basic encoding. In some cases, this \nmight seek to prevent the activity from being picked up by endpoint solutions, and in \nothers, simply to compress the size of data being exfiltrated. PwC has observed this \ntrend continue across all categories of threat actors in 2021 and at different levels of \nsophistication. One example is threat actor ReconHellCat, which we track as Blue Dev 6, \nand for which we have found loose links to Russia-based threat actor Blue Athena (a.k.a. \nSofacy).45 ReconHellCat has made use of a custom base64 encoding mechanism in a \ncampaign targeting a Western government\u2019s Foreign Office, wherein several non-standard \nbase-64 characters were made to replace other characters in the alphabet. \nFigure 4 - ReconHellCat using a custom base64 encoding mechanism with non-standard characters\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "512c5a53-38cf-4b63-93e2-7e622cfaf53a": {"__data__": {"id_": "512c5a53-38cf-4b63-93e2-7e622cfaf53a", "embedding": null, "metadata": {"page_label": "12", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "12  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nCollection\nT1041 Exfiltration Over \nC2 ChannelThreat actors have a need to move the sensitive information they\u2019ve collected from \nthe victim\u2019s machine to their own server. One of the most popular methods for \nachieving this aim is to send it over a dedicated command and control (C2) channel; \na technique which can take a variety of forms. This trend has continued in 2021, \nalthough there are other novel implementations of this technique that threat actors \nof all motivations have begun to adopt, including the use of legitimate exfiltration \ntools, or cloud-based services. For example, ransomware operator White Onibi (aka \nConti) was observed instructing affiliates to make use of the file sharing service \nmega[.]io for C2 exfiltration alongside the tool RClone.45 Threat actors can also \nabuse legitimate cloud platforms, such as Dropbox, for both C2 and exfiltration, as \nwe observed with a RAT known as BoxCaon46 used to target Afghanistan earlier this \nyear, and with Black Shoggoth\u2019s ROKRAT malware.47\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "5277dfdd-93b4-47de-a24a-2a5f2217e868": {"__data__": {"id_": "5277dfdd-93b4-47de-a24a-2a5f2217e868", "embedding": null, "metadata": {"page_label": "13", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "13  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nNew techniques\nThe MITRE ATT&CK framework is constantly being updated with new attacker techniques, allowing for all elements of cyber \nsecurity to better understand and categorise the tactics and techniques being leveraged by threat actors. Below we outline \nsome of the new additions to the MITRE ATT&CK framework in 2021, alongside examples of these techniques where we \nobserved threat actors adopting them.\nFigure 5 - A Red Dev 3 credential phishing page imitating a Google login pageTechnique Description Explanation\nResource \nDevelopment\nT1608 Stage \nCapabilitiesThis entire new set of techniques added to MITRE ATT&CK in 2021 revolves around \nthe threat actor staging certain resources that can be used during the campaign. \nThis technique is in specific reference to capabilities being staged on adversary-\ncontrolled networks that are then accessible to the victim, through either a malicious \nlink, or downloaded onto the victim\u2019s machine through ingress tool transfer. This \ntechnique highlights a section of threat actor preparation that has the potential to \nwidely impact how we think about defending against malicious campaigns. For \nexample, understanding particular domain naming patterns or domain registrars \ncertain threat actors have a habit of using, can allow for the recognition, and \npotential mitigation, of a threat actor\u2019s future campaign. Defenders should take into \naccount possible avenues that threat actors might take for payload staging in their \ndefensive strategy, including legitimate services such as Content Delivery Networks \n(CDNs) or cloud services.\nMost threat actor activity PwC observed across 2021 has made use of these \nStage Capabilities subtechniques, such as Russia-based threat actor Blue Odin\u2019s \nremote template techniques seen being leveraged against Belarus48, China-based \nRed Djinn\u2019s collection of exploits and vulnerability scans left staged on an open \ndirectory49, or China-based threat actor Red Dev 3\u2019s (aka DeepCliff, RedAlpha) fake \nlogin portals for credential theft.50", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "6b8cd031-0466-4a93-a105-a689bf221b34": {"__data__": {"id_": "6b8cd031-0466-4a93-a105-a689bf221b34", "embedding": null, "metadata": {"page_label": "14", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "14  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nDefence Evasion\nT1620 Reflective Code \nLoadingThis technique involves a threat actor either loading or injecting code into the \nmemory of an already running process. We observed it being adopted by numerous \ndifferent threat actors and malware families over the years. A recent example \nincludes activity by India-based threat actor Orange Kala51 (aka Donot), which was \nobserved injecting downloaded shellcode into an already running DLL. The reason \nthis technique remains common is likely because it is difficult to detect, and by \nloading malicious code into a benign or legitimate running process, a threat actor \ncan mask their functionality from standard intrusion detection systems.\nT1036.007 Masquerading: \nDouble File \nExtensionA double file extension (e.g., pdf.lnk) allows for threat actors to mask the nature of \ntheir payloads due to the fact files will in most circumstances render the first file \nextension provided. For example, threat actors such as Black Alicanto52 and Grey \nKarkadann53 commonly use double file extensions as a masquerading technique on \nvictims.\nDiscovery\nT1614.001 System Location \nDiscovery: \nSystem \nLanguage \nDiscoveryThe use of system language discovery is a technique we continued to observe \nover the last year \u2013 particularly amongst ransomware threat actors such as White \nUrsia (aka Sodinokibi, REvil), White Apep, and White Austaras \u2013 preventing the \nransomware from detonating and encrypting systems belonging to organisations that \noperate in specific areas (typically including Russia and post-Soviet States).54\nT1016.001 System Network \nConfiguration \nDiscovery: \nInternet \nConnection \nDiscoveryThreat actors have been known to test for internet functionality before deploying \ntheir malware\u2019s command and control (C2) capabilities. This is often done to ensure \nthat the malware is able to connect back to a threat actor-controlled server, and to \navoid isolated analysis systems or malware sandboxes. Connection tests typically \ninvolve resolving a common internet domain that would not stand out among a \nvictim organisation\u2019s traffic. For example, we observed Iran-based threat Yellow \nLiderc55 making use of the ping functionality alongside several domains that would \nexperience a large degree of traffic (e.g., Yahoo, Google, Github), testing for a \nresponsive ping. Crime-motivated actors such as White Horoja (aka Qakbot) were \nalso observed using this technique, with QakBot56 malware also assessing the \nvictim\u2019s download speed for future payloads.\nFigure 6 - A Yellow Liderc macro executing commands fingerprinting the victim environment and checking connectivity \nby pinging common domains", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "d0979b92-4d92-4e39-b882-c6cf6301041a": {"__data__": {"id_": "d0979b92-4d92-4e39-b882-c6cf6301041a", "embedding": null, "metadata": {"page_label": "15", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "15  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nMapping intrusions to MITRE ATT&CK\nWhile the previous section listed the techniques that we \nobserved being most frequently used in 2021 by threat actors \nand offered examples of their individual usage, this one \noffers an overview of how several of those techniques may \nbe concatenated as part of intrusion chains we observed. Analysing an attack across all its individual phases, from \npreparation all the way to exfiltration or impact, can help \ndefenders identify actions that might be detectable on the \nnetwork, and consider how their current defences would fare \nagainst such intrusion activity.\nBlack Alicanto\nFigure 7 - Steps of a Black Alicanto intrusion chain involving the Cabbage RAT and msoRAT backdoors\nBlack\nAlicanto Phishing\nemailVictim\nZIP/RAR\nattachmentZIP/RAR\nattachment\n Cabbage\nRAT-A\nCabbage\nRAT-BLNK in startup\n 2nd stage\nC2 server 1st-stage  \nC2 serverInfostealer\nmodules\nmsoRAT\nbackdoorCryptocurrency\ntheftCabbage\nRAT-CLure doc w/\npassword\n Password\n.txt.lnk\nbit.ly URL", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "7c2672cd-8816-4807-88d4-159ce55fe4c9": {"__data__": {"id_": "7c2672cd-8816-4807-88d4-159ce55fe4c9", "embedding": null, "metadata": {"page_label": "16", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "16  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n1.  The threat actor sends a phishing email to the target, with \na RAR archive attached.\n a.   Phishing: Spearphishing Attachment -  \nhttps://attack.mitre.org/techniques/T1566/001/\n2.  The user is provided with instructions in the email to open \nthe RAR archive, and execute the lure document inside \nusing the password provided.\n a.   User Execution: Malicious File -  \nhttps://attack.mitre.org/techniques/T1204/002/\n3.  The threat actor would either use a lure document with \nmacros, or a LNK file with a double extension. \n a.  Command and Scripting Interpreter: Visual Basic - \nhttps://attack.mitre.org/techniques/T1059/005/\n b.  Masquerading: Double File Extension -  \nhttps://attack.mitre.org/techniques/T1036/007/\n4.  The document macros/LNK is used to download the \nCabbage RAT-A from a bit.ly shortened URL onto the \nvictim\u2019s system.\n a.  Stage Capabilities: Link Target - https://attack.mitre.\norg/techniques/T1608/005/\n b.  Stage Capabilities: Upload Malware -  \nhttps://attack.mitre.org/techniques/T1608/001/\n5.  Cabbage RAT-A is a loader, and has the functionality of \nloading Cabbage RAT-B into memory, while also placing \nan LNK of itself in startup for persistence:\n a.  Boot or Logon Autostart Execution: Registry  \nRun Keys / Startup Folder -  \nhttps://attack.mitre.org/techniques/T1547/001/\n b.  Reflective Code Loading -  \nhttps://attack.mitre.org/techniques/T1620/\n6.  CabbageRAT-B is a fingerprinting malware, written in \nVisual Basic, and has the functionality to collect the \nvictim\u2019s system, network, and user information, sending \nit back to the C2 used to download Cabbage RAT-A \nover an HTTP POST request. This starts a two-way \ncommunication with the C2, which allows for new code \nto be downloaded by Cabbage RAT-B - including a \nmalware known as Cabbage RAT-C - which will be initially \nencoded.\n a.  Command and Scripting Interpreter: Visual Basic - \nhttps://attack.mitre.org/techniques/T1059/005/\n b.  System Information Discovery -  \nhttps://attack.mitre.org/techniques/T1082/\n c.  System Network Connections Discovery -  \nhttps://attack.mitre.org/techniques/T1049/d.   System Owner/User Discovery -  \nhttps://attack.mitre.org/techniques/T1033/\ne.  System Time Discovery -  \nhttps://attack.mitre.org/techniques/T1124/\nf.  Application Layer Protocol: Web Protocols -  \nhttps://attack.mitre.org/techniques/T1071/001/\ng.  Data Encoding: Standard Encoding -  \nhttps://attack.mitre.org/techniques/T1132/001/\nh.  Exfiltration Over C2 Channel -  \nhttps://attack.mitre.org/techniques/T1041/\n7.  Cabbage RAT-C is also a human-operated ransomware \nwritten in Visual Basic, capable of being given commands \nfrom a hardcoded C2 server that provide the malware \nwith a multitude of functionality, including: file upload, \ndownload, and deletion capabilities, executing code \nsnippets passed to it (this can be encoded), and setting \ncurrent directories.\n a.  Command and Scripting Interpreter: Visual Basic - \nhttps://attack.mitre.org/techniques/T1059/005/\n b.  Data Encoding: Standard Encoding -  \nhttps://attack.mitre.org/techniques/T1132/001/\n c.  Indicator Removal on Host: File Deletion -  \nhttps://attack.mitre.org/techniques/T1070/004/\n d.  File and Directory Discovery -  \nhttps://attack.mitre.org/techniques/T1083/\n e.  Data from Local System -  \nhttps://attack.mitre.org/techniques/T1005/\n f.  Exfiltration Over C2 Channel -  \nhttps://attack.mitre.org/techniques/T1041/\n8.  One of the files observed being downloaded by \nCabbageRAT-C is a payload known as msoRAT which, \nalongside having its own file upload and download \ncapabilities, also has unique privilege escalation and \nexfiltration methods, as well as process injection and \ncredential stealing functionality.\n a.  Data Encoding: Standard Encoding -  \nhttps://attack.mitre.org/techniques/T1132/001/\n b.  Exfiltration Over Alternative Protocol: Exfiltration Over \nUnencrypted/Obfuscated Non-C2 Protocol -  \nhttps://attack.mitre.org/techniques/T1048/003/\n c.  Credentials from Password Stores:  \nCredentials from Web Browsers -  \nhttps://attack.mitre.org/techniques/T1555/003/\n d.  Archive Collected Data: Archive via Utility -  \nhttps://attack.mitre.org/techniques/T1560/001/", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "82d67016-69e6-43a3-8b67-05bdb36c8839": {"__data__": {"id_": "82d67016-69e6-43a3-8b67-05bdb36c8839", "embedding": null, "metadata": {"page_label": "17", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "17  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nFigure 8 - Steps of a White Apep intrusion chain deploying BlackMatter ransomware\nRubeus SharpHound PowerPick\nBlackMatter\nramsomware\n Cobalt\nStrikeCredential\nstealing tools\nAdmin\naccountLateral\nmovementVictims server Victim RDS\nserverBlackMatter\naffiliateObtain credentials of\nvictim pre-attackDetonated after\nsensitive document\nexfiltrated\nDark Web\nforum\nSensitive\ndocuments\nWinSCP Threat actor C2Stagings ServerVictim\nnetwork\n1.  White Apep uses the dark web to purchase credentials for \ncompromised corporate accounts of organisations based \nin the US, UK, Canada, or Australia, specifying that the \norganisation\u2019s revenue must exceed US$1m, and have \n500 to 15,000 hosts. Once bought, these credentials are \ngiven to the affiliate threat actor who is to conduct the \noperation on the victim organisation. \n a.  Gather Victim Org Information: Identify Roles - \nhttps://attack.mitre.org/techniques/T1591/004/\n b.   Gather Victim Host Information: Software -  \nhttps://attack.mitre.org/techniques/T1592/002/\n c.  Gather Victim Identity Information: Credentials - \nhttps://attack.mitre.org/techniques/T1589/001/\n2.  The affiliate performs active scanning to find a public \nfacing Remote Desktop Server (RDS) of the victim, which \nthey can plug the credentials into, gaining access to the \nvictim\u2019s system.\n a.  Valid Accounts: Local Accounts -  \nhttps://attack.mitre.org/techniques/T1078/003/\n b.  Active Scanning: Vulnerability Scanning -  \nhttps://attack.mitre.org/techniques/T1595/002/\n3.   Through the RDS server, the threat actor is able to move \nto other servers, subsequently installing Cobalt Strike.\n a.  Stage Capabilities: Upload Malware -  \nhttps://attack.mitre.org/techniques/T1608/001/\nb.  Exploitation of Remote Services -  \nhttps://attack.mitre.org/techniques/T1210/\nc.  Remote Services: Remote Desktop Protocol -  \nhttps://attack.mitre.org/techniques/T1021/001/\n4.  The Cobalt Strike payload is used to install additional \nnetwork scanning tools, such as Rubeus, PowerPick, \nand SharpHound. It is also later used to download \nthe ransomware payload for encryption of the victim\u2019s \nnetwork.\n a.  Network Share Discovery -  \n https://attack.mitre.org/techniques/T1135/\n b.   System Network Connections Discovery -  \nhttps://attack.mitre.org/techniques/T1049/\n c.    Ingress Tool Transfer -  \nhttps://attack.mitre.org/techniques/T1105/\n5.  Using Cobalt Strike and the extra commodity tools \ndownloaded, the threat actor is able to conduct lateral \nmovement onto further victim servers.\n a.  Lateral Tool Transfer -  \nhttps://attack.mitre.org/techniques/T1570/White Apep", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "3d236b9d-0c10-4c37-be7b-608dd421cff4": {"__data__": {"id_": "3d236b9d-0c10-4c37-be7b-608dd421cff4", "embedding": null, "metadata": {"page_label": "18", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "18  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n6.  Other tools are also downloaded through this Cobalt \nStrike payload, including Brute Force and Kerber, which \nare used in tandem with a DCSync attack to obtain \ncredentials for an account with Administrative privileges. \n a.  Account Discovery: Domain Account -  \nhttps://attack.mitre.org/techniques/T1087/002/\n b.  Domain Trust Discovery -  \nhttps://attack.mitre.org/techniques/T1482/\n c.  Group Policy Discovery -  \nhttps://attack.mitre.org/techniques/T1615/\n d.  Permission Groups Discovery: Domain Groups - \nhttps://attack.mitre.org/techniques/T1069/002/\n e.   Brute Force: Credential Stuffing -  \nhttps://attack.mitre.org/techniques/T1110/004/\n f.  OS Credential Dumping: DCSync -  \nhttps://attack.mitre.org/techniques/T1003/006/\n g.  Valid Accounts: Domain Accounts -  \nhttps://attack.mitre.org/techniques/T1078/002/\n7.  With Administrative privileges now secure, the threat actor \nis able to scan the network for sensitive files, exfiltrating \nthem via the WinSCP file transfer tool.\n a.  Exfiltration Over Alternative Protocol: Exfiltration \nOver Unencrypted/Obfuscated Non-C2 Protocol - \nhttps://attack.mitre.org/techniques/T1048/003/\n b.  Data from Local System -  \nhttps://attack.mitre.org/techniques/T1005/\n c.   Data from Network Shared Drive -  \nhttps://attack.mitre.org/techniques/T1039/\n8.  The BlackMatter ransomware is placed on every available \nendpoint in the network, and subsequently detonated. The \nmalware itself has privilege escalation functionality should \nit need it, but will mainly be used to encrypt most files on \nthe infected device.\n a.  Abuse Elevation Control Mechanism:  \nBypass User Account Control -  \nhttps://attack.mitre.org/techniques/T1548/002/\n b.   Obfuscated Files or Information: Software Packing - \nhttps://attack.mitre.org/techniques/T1027/002/\n c.   Obfuscated Files or Information:  \nCompile After Delivery -  \nhttps://attack.mitre.org/techniques/T1027/004/\n d.  Exploitation for Privilege Escalation -  \nhttps://attack.mitre.org/techniques/T1068/\n e.  Data Encrypted for Impact -  \nhttps://attack.mitre.org/techniques/T1486/\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "042e43d3-2dca-4676-abca-19540f6bed63": {"__data__": {"id_": "042e43d3-2dca-4676-abca-19540f6bed63", "embedding": null, "metadata": {"page_label": "19", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Back to BEC\nA particular type of incident involving social engineering and \ncyber-enabled fraud whose prevalence and impact should \nnot be underestimated is Business Email Compromise (BEC). \nBEC involves a threat actor hijacking or closely imitating a \nlegitimate email account, or impersonating some entity or \nperson, in order to socially engineer individuals, mainly to \nconvince them to make payments to a threat actor-controlled \nbank account. BEC attacks centre on social engineering \nand victim manipulation, but more sophisticated cases may \ninvolve several other techniques, including the compromise or \nabuse of valid credentials to gain initial access to a network, \nor even malware.BEC scams may vary widely in scope, but across the board \ncan have devastating effects on individual victims and cause \nmaterial economic loss to organisations. In 2020 alone, \nthe US Internet Crime Complaint Center (IC3) reported \nthat losses from BEC cases exceeded US$4.1bn.57 This \nfigure, which only includes the United States, needs to be \nconsidered in the context of a type of fraud that is for the \nmost part under-reported and a global threat.\nIn 2021, our Incident Response team provided support on \nmultiple BEC cases across different countries. In both of the \ncase studies outlined below, the threat actor pretended to \nact on behalf of a sister or affiliated organisation or party in a \ncountry different from the victim organisation\u2019s own.19  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nIncident Response case study: BEC incident in  \nSoutheast Asia\nA Southeast-Asian victim organisation received a number of emails, \nsupposedly from a related party in the Philippines, advising that  \npayments should be made to alternative bank accounts supposedly \nbelonging to them. The alternative bank accounts allegedly owned  \nby the victim\u2019s sister company were opened in Malaysia, and actually \ncontrolled by a threat actor. \n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "56fb0f90-ef60-4f9b-a8db-e386e4902253": {"__data__": {"id_": "56fb0f90-ef60-4f9b-a8db-e386e4902253", "embedding": null, "metadata": {"page_label": "20", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "20  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nSince at least late 2020, \na threat actor likely \ncompromised an  \nAustralian company.\nThe threat actor \nwas able to read the \nemail conversation \nbetween the Australian \ncompany and PwC\u2019s \nDutch client.The threat actor exchanged \nemails with the Australian \ncompany. Follow-ups and \nemails containing payment \ninstructions appeared to \noriginate from the Dutch \ncompany\u2019s chief financial \nofficer and chief  \ncommercial officer.The Australian company \nreceived the new bank \ndetails, transferred the \nfunds, and believed \nthey had completed the \nbusiness deal with the \nDutch organisation.The threat \nactor followed \nup with \nthe Dutch \norganisation \nfurther, still \nimpersonating \nthe Australian \ncompany, to \nbuy time while \nthe funds \nwere being \ndeposited.In early January 2021, the \nthreat actor sent an email \nto the Australian company. \nThe email contained a copy \nof the previous email thread, \nand included threat actor-\ncontrolled email addresses that \nmasqueraded as employees of \nthe Dutch organisation.The threat actor sent \nanother email, requesting \nthe Australian organisation \nto send the funds to a new \nbank account in Hong Kong \n(controlled by the threat \nactor).At this point, the threat actor \nalso responded to the Dutch \norganisation impersonating \nits Australian client, saying \nthat the invoices had been \nprocessed.\nLate  \n2020January  \n2021Incident Response case study: banking on trust across the globe", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "98d33c75-784c-4d61-b963-12ab52f22037": {"__data__": {"id_": "98d33c75-784c-4d61-b963-12ab52f22037", "embedding": null, "metadata": {"page_label": "21", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Threat vector spotlight: \ncredential access\nIn 2021, we observed threat actors of all motivations \nseeking initial access into victim networks by exploiting valid \ncredentials58 either obtained through dark web markets, or \nthrough earlier credential phishing campaigns.59\nFor example, in December 2021 Mandiant60 reported \nthat clusters of activity associated with the threat actor \nresponsible for the SolarWinds intrusion, which we track \nas Blue Dev 5, gained initial access into some victim \norganisations by using legitimate credentials. Blue Dev \n5 likely obtained these from a third-party actor that had \ngathered them through a prior info-stealer malware \ncampaign. \nPwC\u2019s tracking of ransomware operator White Apep (aka \nDarkside, BlackMatter) \u2013 both from research by the threat \nintelligence team and engagements conducted by our \nincident response team \u2013 also reveals how ransomware threat \nactors made use of legitimate credentials as one of their main \nattack vectors.61 Among these, White Apep was observed \nattempting to purchase credentials of organisations of a \ncertain size from Russian-speaking dark web forums, which \nwould be used in valid accounts attacks.62Credential marketplaces\nAnalysis of the trade in compromised access credentials in \nthree major criminal forums has highlighted the high volumes \nof data and access currently available to criminal threat \nactors, either through the simple leaking of compromised \ndata, through auctions, or through private sales to individual \nbuyers. The main sectors favoured by vendors are:\n\u2022 Financial Services;\n\u2022 Government;\n\u2022 Technology, Media and Telecommunications; and,\n\u2022 Retail.\nOn the forums that PwC monitors, over a three-month period \nat least 600 threat actors were involved in the sale of access \ncredentials, compromised databases, collections of identity \ndocuments, and at least 12 vulnerabilities or their associated \nexploits. While ransomware actors are an obvious client  \nbase for these marketplaces, access to e-commerce  \nplatforms likely for exploitation by payment card fraud  \nwas also evident.6321  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nIncident Response case study: valid credentials transport CryLock\nPwC responded to an incident impacting an organisation in the transport sector, whose subsidiary was hit by a CryLock \nransomware attack. The threat actor gained initial access to the network by abusing valid credentials that had been \ncompromised and leaked. The threat actor proceeded to deploy CryLock ransomware on critical systems that resided on the \nsame network segment as operational technology (OT) systems, which were involved in critical functions for the business. Both \nOT and IT were compromised as part of the incident, with the threat actor demanding a ransom to revert systems from their \nunusable state.\nAn important detail that emerged from the incident response process was that the client was unaware that the subsidiary\u2019s \ncyber security was under their governance until the attack happened. This stresses the need for organisations, particularly \nthose that have subsidiaries or related entities, to have clear policies and governance structures in place for information and \ncyber security. It also highlights the importance of incident response playbooks that detail roles, responsibilities, and plans to \nfollow in case of compromise, and which have been tried and tested in exercises prior to an actual real-world event to ensure \nthat they are viable and adequate.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "7479042d-2471-4556-9ffd-05dd9ab68a16": {"__data__": {"id_": "7479042d-2471-4556-9ffd-05dd9ab68a16", "embedding": null, "metadata": {"page_label": "22", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "22  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nTrends in  \ndetection", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "eedc83f5-dea1-410c-af93-3a4de557c3f5": {"__data__": {"id_": "eedc83f5-dea1-410c-af93-3a4de557c3f5", "embedding": null, "metadata": {"page_label": "23", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Network\nIn the last year, we added 1,300 content rules, and an \nadditional 21,000 simple IOC rules, to our network threat \ndetection holdings. These new rules cover over 90 threat \nactors, 30 of which were new this year, and 200 cover  \nunique pieces of malware, plus a wide range of more  \ngeneric detections.There have been many write-ups of the format of the Gh0st \nRAT payload header, to enable defenders to better detect \nthe malware\u2019s network traffic. In its basic, standard form the \npayload header can be summarised as:\n\u2022 The fingerprint string, defaulting to Gh0st;\n\u2022  Four bytes for the total size of the payload and this \nheader;\n\u2022  Four bytes for the size of the payload once \nuncompressed;\n\u2022 Zlib compressed payload (begins with 0x78 0x9c).\nTypical Gh0st network packets will start with this:\n 00000000 47 68 30 73 74 ee 01 00 00 2e 06 00 00 78 9c b6\nGh0st... ./...x..\n Since this initial beacon, and most server responses, will\n be small, it is tempting to write a generic detection like the\nfollowing when writing a network signature:\n content:\u201d|00 00 78 9c|\u201d; offset:11; depth:20;\ncontent:\u201d|00 00|\u201d; distance:-8; within:2;\nDeploying a signature like this, though, would be a mistake \nas there is a lot of legitimate network traffic that has ZLIB \ncompressed payloads that match this \u2013 particularly backup \nsoftware. Thankfully most modern IDS platforms have ways \nof doing extended processing on detections. For example, \nwith Suricata and Snort 3.x it is possible to use Lua, and \nZeek has native scripting. Simply comparing the size of the \npacket against the size in the header is a good starting point.\nWe can then take this a step further, and decompress the \npayload. The first (decompressed) byte of the Gh0st payload \nidentifies the command or token, enabling detailed alerting \nor logging. The total size of the decompressed payload can \nalso be compared against the size in the header for further \nreduction of false positives.\nThis approach is something we use across a range of \nmalware, decoding communication to improve both detection \nconfidence and the quality of information available to \ndefenders. Monitoring network egress points for malware is \na simple and effective way of providing coverage to an entire \nnetwork. This complements host-based detection, where \ndeployed, and provides coverage of devices that cannot have \nagents deployed.Finding the Gh0st in the machine\nIn the spring of 2009, the Information Warfare Monitor \npublished an article titled Tracking GhostNet64, in which \nthey discussed Gh0st RAT. This well-known malware family \nis named after the default fingerprint string the malware \nuses as the start of its malware traffic: Gh0st. Despite over \na decade having passed, and after the leak of its source \ncode, Gh0st RAT is still in use today, with a wide range of \nfingerprint strings and several China-based threat actors \nhaving used variants of it.65 In 2021, hunting for Red Menshen \nactivity, we identified a custom variant of Gh0st RAT used \nby the threat actor between at least August 2020 and March \n2021. Red Menshen\u2019s Gh0st RAT variant contained non-\nstandard fingerprint strings and server-side packet markers, \nand connected on port 10,000 to C2 servers mainly having \nAlibaba IP addresses.66 Red Djinn also used a custom  \nvariant of Gh0st RAT (known also as Consock and \nGh0stTimes) throughout 2020 and 2021, in activity mainly \ntargeting organisations in East Asia as well as,  \noccasionally, in the US.6723  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n  T1071, 72.7%\n  Other, 9.2%\n  T1190, 9.2%\n  T1095, 3.4%\n  T1573, 3.1%\n  T1090, 2.5%\nSource: PwCFigure 9 - MITRE mapping - network", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "a9565152-f6d6-4c96-9708-94ff8a79bfaa": {"__data__": {"id_": "a9565152-f6d6-4c96-9708-94ff8a79bfaa", "embedding": null, "metadata": {"page_label": "24", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Endpoint\nIn 2021, we created 1,088 additional endpoint behavioural \ndetection rules, spanning multiple endpoint detection and \nresponse tool syntaxes. Execution and Evasion remain the \nmost prevalent tactics that we observe at the endpoint level, \nas threat actors use a wide variety of techniques to achieve \ncode execution and escape system controls. DLL hijacking remains an extremely common technique, \nsince it allows the threat actor to achieve code execution, \nand to do so from the context of a process that is not as likely \nto be monitored for abuse, hence evading defences. China-\nbased threat actors have been performing various modes \nof DLL hijacking \u2013 including sideloading legitimate benign \nexecutables, or search order hijacking \u2013 to load different \nmalware families for years, and this trend has continued in \n2021. For example, Red Dev 17 has used these techniques to \nload and execute Chinoxy68 as well as a PoisonIvy variant69; \nmeanwhile Red Orthrus (aka APT23, Keyboy) did so to \nexecute the KeyBoy RAT (aka CotXRAT).70\nDuring post-exploitation, while PowerShell remained \ncommon, we observed threat actors and offensive security \nframeworks increasingly adopting .NET and C# tools (for \nexample Sharpshell, Sharpsploit, or Sharphound) which are \nmore likely to successfully evade detection. While extremely \npopular still, the former has attracted more scrutiny from \ndefenders and become subject to heightened security \ncontrols over the last few years. Advances in Cobalt Strike \nevasion also became more prominent, with greater usage \nof Cobalt Strike Beacon Object Files which enable greater \nstealth capabilities. We saw greater focus on unhooking EDR \nand other security products from the OS, which effectively \nprevents them from seeing the activity the attacker is running \nwhile the security product remains in a running state. Using \ncompromised or vulnerable drivers in order to gain the \nrequired access into the OS has also maintained traction.24  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n  TA0005, 33.7%\n  Other, 24%\n  TA0002, 16%\n  TA0003, 13.3%\n  TA0004, 6.9%\n  TA0001, 6.1%\nSource: PwCFigure 10 - MITRE tactics mapping - endpoint\n TA0001 -  Initial Access\nTA0002 -  Execution\nTA0003 -  Persistence\nTA0004 -  Privilege Escalation\nTA0005 -  Defence Evasion\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "577416b3-168c-42b0-8d0f-372ac4c67eef": {"__data__": {"id_": "577416b3-168c-42b0-8d0f-372ac4c67eef", "embedding": null, "metadata": {"page_label": "25", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Payload staging\nFor example, Scarlet Ioke (aka Ocean Lotus, APT32) likely distributed Cobalt Strike beacons bundled into archives \nvia Dropbox71, and the threat actor PwC tracks as White Dev 85 previously hosted lure documents on both Dropbox \nand OneDrive72. PwC observed Black Shoggoth (aka APT37) downloading a ROKRAT variant from a Google Drive \ninstance, which then attempted to download another file from a Box instance and sent fingerprinting information to a \npreconfigured Dropbox account73. The backdoor, a staple in the threat actor\u2019s arsenal, can also be configured to interact \nwith other legitimate services74. \nExfiltration\nIn the training materials purportedly belonging to White Onibi, the threat actor in control of Conti ransomware, recruits \nwere instructed to register for mega[.]io, a file sharing service, and use Rclone75 to exfiltrate data from disk to this \nservice76. Additionally, freely available open source frameworks such as FSecure C377 can also be configured to use \nnumerous legitimate services for C2 channels, including but not limited to Slack, Discord, GitHub and OneDrive, further \nextending the C2 capabilities of tools like Cobalt Strike.\nC2 interaction\nAdditionally, some services also publish an API, allowing developers and malware authors alike to interact with the \nservice. In May 2021, we observed a campaign targeting Afghan government entities with a Remote Access Trojan \n(RAT) that uses Dropbox for C2 activity78. The malware, which is referred to as BoxCaon in open source79, contains a \nhardcoded bearer access token to interact with Dropbox. After installation, the malware creates a victim-specific folder \non the Dropbox repository, and uses the Dropbox API to upload files, execute commands, or read files from the C2. 25  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nCase study: hiding in plain sight - abusing \nlegitimate services for malware delivery and C2\nThroughout 2021, file-sharing services and messaging \nplatforms continued to be abused by threat actors to stage \nlure documents, spread malware, and implement command \nand control (C2) and exfiltration channels. While the use of \nlegitimate collaboration and communication services for \nnefarious purposes is not new, the increased reliance of \nmany businesses on these services for day-to-day operations \nmakes them an attractive option for threat actors to bypass \nperimeter security controls. From a defender\u2019s perspective, \nthe difficulty lies in discerning between benign and malicious \nuse of legitimate services.\nThreat actor abuse of legitimate services proves challenging as it can provide a mechanism for bypassing web filtering allow \nlists. Furthermore, this can make network detection more difficult, especially if these services are in use at a victim organisation \nor one of its third parties, which allows the malicious communications to blend in with legitimate traffic. In addition to standard \ndata loss prevention and access management approaches, there are a range of options for detection of anomalous use of \nthese services. In order to reduce the risks associated, consideration should be given to restricting traffic to only authorised or \nbusiness critical file-sharing and collaboration services across the environment, coupled with employee training to understand \nthe risks associated with these external services. Endpoint detection methods would involve checking for access to these sites \nfrom non legitimate service applications or browser processes. Signer checks should be involved to ensure that masquerading \nis not used to bypass detection, as well as checks for process injection into these native legitimate service applications (such \nas checking for process injection into Dropbox.exe). Further checks to ensure that detections aren\u2019t bypassed would be to \ncheck for any DLL hijacking vulnerabilities for these legitimate service applications that would allow a threat actor to load a \nmalicious DLL into the process.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "99b84caf-544a-4a68-a225-400bc699b278": {"__data__": {"id_": "99b84caf-544a-4a68-a225-400bc699b278", "embedding": null, "metadata": {"page_label": "26", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "26  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n2021 saw a large portion of our detection rules written for \nthreat actors based in the Asia Pacific (APAC) region. There \nare several reasons for this: the first and foremost being our \nspecific visibility and collection which will inevitably differ, to \nsome extent, from those of other organisations. We observed \na high volume of different malware families and variants being \ndeveloped and updated by threat actors based in APAC, \nwith heavy reliance on custom implants and backdoors as \nopposed to living-off-the-land or off-the-shelf tools.\nMEA-based threat actors were also observed using diverse \ntechniques, including credential phishing and social \nengineering, through to commercial and open source \ntools such as remote utilities. In tracking such threats, we \nfocused on tracking of infrastructure (including domain \nnaming conventions and egress infrastructure), network data \nanalysis, as well as hunting for samples based on strategic \nattributes.Our investigations into malicious activity by threat \nactors based in Europe focused even further on infrastructure \ntracking and hunting for initial stage lure documents using \nheuristic terms. Samples of malware attributed to Russia-\nbased as well as other Europe-based threat actors are not as \nfrequent to come by in open source or from our visibility into  \nnetworks and collection. \nCase study: hunting for encoded payloads  \nwith YARA\nIn this section, we will highlight a couple of YARA rules we \nwrote in 2021 which are searching for encoded files. By \nfocusing on encoding mechanisms and custom formats, we \nwere able to uncover more samples that we might otherwise \nmiss across malware families used by multiple threat actors. \nThe comments within the YARA  rules that we share below \ndescribe the detection logic we applied.\nFigure 11 - YARA rule breakdown per threat actor region\n  APAC, 59.8%\n  N/A, 19.5%\n  CRIME, 9.8%\n  MEA, 5.5%\n  EURO, 5.4%\nSource: PwCYara", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "e5abe010-91ab-436a-990c-3a899afb13b6": {"__data__": {"id_": "e5abe010-91ab-436a-990c-3a899afb13b6", "embedding": null, "metadata": {"page_label": "27", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "27  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nRed Lich Encoded PlugX\nimport \u201cmath\u201d\nrule Red_Lich_Encoded_PlugX : Red_Lich {\n meta:\n  description = \u201cDetects PlugX payloads that have been encoded with a multi-byte XOR key (of varying \nlength) that is stored at the start of the file. Many of these decoded payloads are associated with Mustang \nPanda.\u201d\n  TLP = \u201cWHITE\u201d\n  author = \u201cPwC Cyber Threat Operations\u201d\n  copyright = \u201cCopyright PwC UK 2021 (C)\u201d\n  created_date = \u201c2021-03-31\u201d\n  modified_date = \u201c2021-10-29\u201d\n  revision = \u201c3\u201d\n  hash = \u201c5eaaf8ac2d358c2d7065884b7994638fee3987f02474e54467f14b010a18d028\u201d\n  hash = \u201cd69d200513a173aff3a4b2474ccc11812115c38a5f27f7aafe98b813c3121208\u201d\n  hash = \u201c94c7965e0fba7deb71ca0ff7901b1a1074b41140528ea5bc75a14dfbd3782c8b\u201d\n  hash = \u201c56e9b0c2b87d45ee0c109fb71d436621c7ada007f1bd3d43c3e8cf89c0182b90\u201d\n  reference = \u201chttps://twitter.com/dtcert/status/1454022175254618114\u201d\n strings:\n  $dos = \u201cThis program cannot be run in DOS mode.\u201d\n  \n condition:\n\t \t //\tRule\tout\tsome\tfile\theaders\n  (\n   uint16(0) != 0x5A4D and //PE\n   uint32(0) != 0x464c457f and //ELF\n   uint32be(0) != 0x504B0304 and //ZIP\n   uint32be(0) != 0x41564620 and //AVF\n   uint32be(0) != 0x414b504b and //PKG\n   uint16be(0) != 0x4944 and uint8(2) != 0x33 and //MP3\n   uint32be(0) != 0x25504446 and //PDF\n   uint32be(0) != 0xd0cf11e0 and //PPT\n   uint32be(0) != 0x4d534346 and //CAB\n   uint32be(0) != 0x556e6974 and //Unity\n   uint32be(0) != 0x38425053 and //PSD\n   uint32be(0) != 0x63616666 and //caff\n   uint32be(0) != 0x64617461 and //data\n   uint32be(0) != 0x664c6143 and //fLaC\n   uint32be(0) != 0x424b504b // BKPK\n  ) and \n  (\n   not $dos\n  ) and\n  //\tStrict\tfilesize\n  (filesize > 50KB and filesize < 800KB) and\n  //\tCheck\tif\tthere\tis\tan\tXOR\tkey\tat\tthe\tbeginning\tof\tthe\tfile\tin\tthe\trange\t[A-Za-z]\n  for any i in (4 .. 0x1F) : (\n   uint8(i) == 0x00 and for all j in (0 .. i-1) : (\n    for any k in (0x41 .. 0x5A) : (\n     uint8(j) == k\n    ) or for any k in (0x61 .. 0x7A) : (\n     uint8(j) == k\n    )\n   )\n  ) and\n  //\tEntropy\tshould\tbe\tsufficiently\thigh\n  (math.entropy(0, filesize) >= 6.8 and math.entropy(0, filesize) < 7.9) and\n  //\tCheck\tthat\tthe\tlast\t10\tcharacters\tare\tin\tthe\trange\t[A-Za-z]\n  for all i in (filesize - 10 .. filesize - 1) : (\n   for any j in (0x41 .. 0x5A) : (\n    uint8(i) == j\n   ) or for any j in (0x61 .. 0x7A) : (\n    uint8(i) == j\n   )\n  )\n}", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "f6f3525b-ea12-4107-8383-9926ce031e79": {"__data__": {"id_": "f6f3525b-ea12-4107-8383-9926ce031e79", "embedding": null, "metadata": {"page_label": "28", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "28  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nThroughout 2021, we continued to monitor the activity of the \nChina-based threat actor we track as Red Lich (aka Mustang \nPanda). In particular, we have previously reported on variants \nof the PlugX remote access trojan which it has used to target \na variety of organizations globally, and written several YARA \nrules to detect these variants and its loaders.\nHowever, a challenge to tracking these samples is in \nidentifying the encoded versions of PlugX. The actual PlugX \nRAT is never written to disk in a plaintext format; instead, it is \nXOR-encoded with a variable length key which is prepended \nto the encoded file, and decoded at runtime by a loader \ncomponent.As such, we sought to develop a YARA rule to detect the \nencoded variants of PlugX, taking advantage of the fact that \nthe encoded payload only uses alphanumeric characters for \nits XOR key. Using this rule (and some automation scripts to \nhelp decode them and extract configurations), we were able \nto map out many more samples and IoCs associated with \nRed Lich.\nRed Apollo/Red Kelpie MS13-098 DLLs\nimport \u201cpe\u201d\nimport \u201cmath\u201d\nrule Microsoft_Signed_DLL_With_High_Entropy_Data_After_Digital_Signature : Heuristic_and_General {\n meta:\n  description = \u201cDetects Windows signed DLLs that have had a payload encrypted and embedded in the \ndigital signature section which is at least 50KB in size (seen by APT10 with its DESLoader/SigLoader \ncampaigns)\u201d\n  TLP = \u201cWHITE\u201d\n  author = \u201cPwC Cyber Threat Operations :: BitsOfBinary\u201d\n  copyright = \u201cCopyright PwC UK 2021 (C)\u201d\n  license = \u201cApache License, Version 2.0\u201d\n  created_date = \u201c2021-02-19\u201d\n  modified_date = \u201c2021-02-19\u201d\n  revision = \u201c0\u201d\n  hash = \u201c8ef94327cab01af04a83df86a662f3abe9ae35aa1084eff7273d8292941bebdb\u201d\n  hash = \u201c69adaf19cc19594e0193da88597b6af886f1c0e148ad980fa0fe3f9250d52332\u201d\n  hash = \u201c697be6add418ca9e1ebcef6cc6fdbb6277851e1892e48264b1e6720e48122c40\u201d\n  reference = \u201chttps://www.lac.co.jp/lacwatch/report/20201201_002363.html\u201d\n strings:\n  $timestamp = \u201cMicrosoft Time-Stamp PCA\u201d\n condition:\n  //\tStart\twith\tsome\tinitial\tconditions\tto\trule\tout\tmost\tsamples\t(e.g.\tcheck\tthat\tit\u2019s\ta\tDLL\twith\tone\t\nsignature\tfrom\tMicrosoft)\n  uint16(0) == 0x5A4D and filesize < 1MB and (pe.characteristics & pe.DLL) and pe.number_of_signatures \n== 1 and for any sig in pe.signatures : (\n   sig.subject contains \u201cO=Microsoft Corporation\u201d and\n   sig.subject contains \u201cCN=Microsoft Windows\u201d\n  ) and\n  //\tSanity\tcheck\tthat\tthe\ttimestamp\tstring\twe\u2019re\tlooking\tfor\tis\tactually\tin\tthe\tdigital\tsignature\t\nsection\n\t \t //\tThroughout\tthese\tnext\tconditions,\twe\tonly\tcare\tabout\tthe\tlast\ttimestamp\tstring,\ti.e.\t@\ntimestamp[#timestamp]\n  (\n   @timestamp[#timestamp] > pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].virtual_\naddress and\n   @timestamp[#timestamp] < (pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].virtual_\naddress + pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].size)\n  ) and\n\t \t //\t Check\tthat\tthe\textra\tdata\tat\tthe\tend\tof\tthe\tdigital\tsignature\tsection\t is\tgreater\tthan\t roughly\t5KB\n  (\n   pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].size - (@timestamp[#timestamp] - \npe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].virtual_address) > 5000\n  ) and\n  //\tExtra\tcheck\tto\tmake\tsure\tthe\tentropy\tof\tthis\textra\tdata\tis\tvery\thigh\t(i.e.\tencrypted)\n  (\n   math.entropy(@timestamp[#timestamp], (pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_\nSECURITY].size - (@timestamp[#timestamp] - pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_SECURITY].virtual_\naddress))) > 6\n  )\n}", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "46401197-c835-407d-aed8-6c49e4cbcd22": {"__data__": {"id_": "46401197-c835-407d-aed8-6c49e4cbcd22", "embedding": null, "metadata": {"page_label": "29", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "29  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nBetween late 2020 and early 2021, multiple open source \nreports explored campaigns operated by the China-based \nthreat actor we track as Red Apollo (aka APT10, menuPass).80 \n81 Such research detailed a variety of different malware \nfamilies used by the threat actor as part of its new campaigns \ntargeting managed service providers.\nAs part of these campaigns, the threat actor chose to \nexploit an old vulnerability, CVE-2013-3900 (also identified \nby Microsoft as MS13-098), which allows a threat actor to \nembed data in the digital signature of some Microsoft signed \nbinaries, but still have the digital signature appear valid. Red \nApollo used this technique to encrypt, and store backdoor \npayloads in the digital signature of DLLs, which it would then \nload at runtime.\nWhile detecting the payloads used by Red Apollo is useful \nfor malware classification, being able to search for samples \nabusing MS13-098 allows us to hunt for any samples using \nthat technique, and potentially to find new payloads. To \nthis end, we wrote the YARA rule \u201cMicrosoft_Signed_DLL_\nWith_High_Entropy_Data_After_Digital_Signature\u201d with the \nfollowing condition:\n\u2022  Determine if the binary is a DLL with one signature, which \nhas organisation \u201cMicrosoft Corporation\u201d, and common \nname \u201cMicrosoft Windows\u201d;\u2022  Find the last occurrence of the string \u201cMicrosoft Time-\nStamp PCA\u201d, and check it lies within the section of \nthe digital signature itself, which is called \u201cIMAGE_\nDIRECTORY_ENTRY_SECURITY\u201d (i.e., to find the \napproximate end of the signature);\n\u2022  Check that from the end of this timestamp that the rest of \nthe \u201cIMAGE_DIRECTORY_ENTRY_SECURITY\u201d section is \ngreater than 5KB (i.e., there is extra data at the end of the \ndigital signature); and,\n\u2022  Finally, check that this extra data has an entropy (a rough \nmeasurement of randomness) higher than the value 6 (i.e., \ncorresponding to potentially encoded/encrypted data).\nNot only did this YARA rule uncover further Red Apollo \nsamples, but was able to detect Red Kelpie (aka APT41, \nBARIUM) using this same technique to load payloads \nincluding CobaltStrike Beacons and the backdoor known \nas SIDEWALK.82 This research was discussed publicly at \nTheSAS2021,83 where we also released a collection of YARA \nrules to detect further Red Kelpie samples.84", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "759bea93-cf64-4860-ad69-809a5a1cec3f": {"__data__": {"id_": "759bea93-cf64-4860-ad69-809a5a1cec3f", "embedding": null, "metadata": {"page_label": "30", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "30  PwC Cyber Threats 2021: A Year in Retrospect - Annex 30  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nCVE \nspotlight ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "520df2cd-13cf-41fc-a730-ea3e19884054": {"__data__": {"id_": "520df2cd-13cf-41fc-a730-ea3e19884054", "embedding": null, "metadata": {"page_label": "31", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "31  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n2021 registered the largest number of 0-days disclosed in a single year85 with 57 reported by Project Zero, more than \ndoubling the 25 reported in 2020. In our 2021 Year in Retrospect report, we provided strategic context for such an increase in \nvulnerability discovery and disclosure, specifically highlighting:\n\u2022  the topic\u2019s renewed prominence in national security conversations; \n\u2022  greater financial incentives; \n\u2022  the activity of commercial brokers; \n\u2022  and, a focus on targeting organisations involved in the software supply chain, leading to a heavier investment of resources \ninto researching vulnerabilities in technologies widely adopted across the public and private sectors.\nVulnerabilities that have long been publicly known continue to be exploited by threat actors, and should not be \nunderestimated. However, the disclosure of 0-days and related exploit code has led to high volumes of intrusion attempts by \nthreat actors of all motivations, particularly in 2021. \nWhile all organisations might not be able to immediately patch or update their systems, it is worth understanding 0-days are \nnot an insurmountable security threat, but rather as previously undisclosed threat vectors whose abuse can often be detected \nor even stopped by defenders. In effect, a focus on detection and response measures, including logging, monitoring, and basic \nsecurity hygiene, can make a difference in the impact that 0-day exploitation might have on organisations.\nThis section discusses several high-profile 0-day vulnerabilities that were disclosed throughout 2021, and some of which were \nquickly incorporated in offensive security tools often abused by threat actors. The vulnerabilities covered here were chosen \ndue to being high-profile, high-impact, or complex to detect. \nMicrosoft Exchange\nWe investigated a collection of critical vulnerabilities in on-premises Microsoft Exchange servers in 2021 which were used by \nboth criminal and espionage-motivated threat actors.\nProxyLogon\nIn March 2021, activity took place surrounding a series of vulnerabilities in on-premises Microsoft Exchange servers, which are \ncollectively referred to as ProxyLogon.86 A China-based threat actor, Red Dev 13, known in open source as HAFNIUM,  began \nexploiting vulnerabilities in Microsoft Exchange likely at the beginning of 2021 to compromise these servers.87 88 While the initial \nactivity surrounding ProxyLogon was associated exclusively with HAFNIUM, at the end of February/beginning of March (close \nto the time of the first public disclosure of these campaigns), multiple China-based threat actors began to start exploiting the \nsame vulnerabilities, on a mass scale rather than with precise targeting.89 In particular, we observed several China-based threat \nactors using the ProxyLogon exploits, including Red Dev 14,90 and Red Djinn (aka BlackTech).91\nIt is not uncommon for China-based threat actors to share tools. However, this level of activity is unprecedented due to the \nrapid sharing of these exploits ahead of the patching of the Exchange vulnerabilities. While we cannot prove that HAFNIUM \ndirectly shared these exploits with other threat actors, given the sudden surge of activity from a wide variety of China-based \nthreat actors before the vulnerability\u2019s public disclosure, it is highly likely they obtained access to the exploit in some format to \nrun their own campaigns and to do a last ditch effort to compromise Exchange servers before they were patched.\nWhile initial proof-of-concepts (PoCs) showed that it was possible to steal emails from an Exchange server without \nauthentication, the real impact came from the potential from authenticated remote code execution on any unpatched Exchange \nserver. This meant that a large amount of the initial activity was that of webshells being deployed, which could then be used by \nthreat actors to take further actions on an infected server, including laterally moving to further systems within an organisation. \nA large proportion of such webshells was the widely-used China Chopper, whose source code is openly available and which, \nfor over a decade, has been deployed by multiple threat actors \u2013 including ones not operating out of China.\nAs is the case with many critical vulnerabilities, eventually threat actors will obtain access to the corresponding exploits, \neither through researching it themselves, or through open source PoCs released by security researchers. It didn\u2019t take long \nwith the Microsoft Exchange vulnerabilities for ransomware threat actors to begin exploiting them, with an eventual strain of \nransomware called DearCry being deployed on unpatched Exchange servers.92 Based on the fact that samples of DearCry \nhad compilation timestamps of 9th March 2021, and that they weren\u2019t as sophisticated as other more established ransomware \nstrains, it is likely that DearCry was developed rapidly in response to the opportunity presented by ProxyLogon.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "a9f04e8a-c86b-462a-b8b7-09af667d1e33": {"__data__": {"id_": "a9f04e8a-c86b-462a-b8b7-09af667d1e33", "embedding": null, "metadata": {"page_label": "32", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Activity like this also raises other concerns. Even if a threat actor drops a webshell to a compromised server and does not use \nit to perform further actions immediately, if the webshell is left installed without remediation then it is possible that either the \noriginal threat actor may use it again in the future, or that other threat actors may search for it to try and gain initial access. \nIn the case of ProxyLogon, many of the webshells used were analysed in open source, or available on online multi-antivirus \nscanners, meaning that the passwords used for the webshells were readily available in open source. \nProxyShell\nLater in 2021, more vulnerabilities were revealed affecting on premises Microsoft Exchange servers, which were named \nProxyShell, and which could again allow for a threat actor to perform unauthenticated remote code execution against \nExchange servers.93 It only took two days before this was observed being exploited in the wild.94\nOur analysis uncovered webshells being dropped by ProxyShell that were then used to then load further payloads to provide \nlightweight backdoor access to an infected system.95 Given the similarity in webshells observed being dropped by ProxyShell \nto that of ProxyLogon, we assessed at the time that the early ProxyShell campaigns were, with realistic probability, conducted \nby that of a China-based threat actor. In particular, there was some similarity to that of webshells used by HAFNIUM by \nProxyLogon before other China-based threat actors began using the same exploits, but we do not have enough evidence to \nattribute these campaigns to HAFNIUM. \nDetection engineering on Microsoft Exchange\nWith the level of access granted by the ProxyLogon/ProxyShell exploits, \nattackers generally seek to gather credentials or move laterally into the \nnetwork. In doing so, they use techniques that are detectable by EDR.\nAn example of a behaviour that can be detected is the creation of a \npotential webshell in the root directory of a web server. Furthermore, we \nhave multiple rules that detect commonly abused Windows processes \nspawned by web server processes. Should a web server process spawn \nan abusable Windows process, a parent-child process relationship will be \ncreated between the two processes. This behaviour is often seen upon \nsuccessful remote code execution, as the code that is being executed \nwithin the web server process will often attempt to use an abusable \nWindows process for the next step in the attack. Lastly, we have high \nconfidence in our detection rules that monitor web server processes \ndropping executables or scripts to disk. Alerts from these detection rules \nwould warrant further investigation.\nA number of our rules detect an attacker\u2019s attempt to steal credentials \nfrom a compromised endpoint. We have rules that detect common \nmemory dumping applications interacting with LSASS \u2013 the Windows \nservice that is responsible for enforcing the security policy on the system, \nfrequently storing credentials in memory. Attackers use memory dumping \napplications to steal credentials: the most well-known of such applications \nis Mimikatz.\nWe signatured two further techniques that were observed in the \nProxyLogon attacks. Focusing in particular on the Exchange server \nprocesses, we signatured the \u2018umworkerprocess.exe\u2019 and \u2018umservice.\nexe\u2019 processes spawning further unexpected processes, which may be \nindicative of the successful exploitation of an Exchange server. Lastly, we \nsignatured \u2018umworkerprocess.exe\u2019 writing non-standard content to disk. \nThis process only writes specific types of files to disk, so a file written \noutside of these types may be indicative of a compromised process.\nVulnerable applications that are exposed to the internet are an \nincreasingly popular vector of initial access for attackers.96 The classic \ninitial access vector using weaponised email attachments \u2013 while still a \nhighly popular and reliable option for attackers \u2013 is facing more hurdles \nas virtualisation and sandbox technologies mature. It is important to \nensure any application that is exposed to the internet is fully patched with \nthe latest security updates. Microsoft released patches for ProxyLogon \nvulnerabilities in March 2021.9732  PwC Cyber Threats 2021: A Year in Retrospect - Annex", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "80d746f2-55fa-4577-973a-deb3d5a69abd": {"__data__": {"id_": "80d746f2-55fa-4577-973a-deb3d5a69abd", "embedding": null, "metadata": {"page_label": "33", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "33  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nIncident Response case study: Austrian company attacked with Makop ransomware\nPwC\u2019s Incident Response team responded to a ransomware attack affecting a client in Austria. The company\u2019s IT \ndepartment started facing problems with its mail server in the end of November, before they had clear evidence that they \nwere the victim of a ransomware attack. The attacker gained remote access at the end of November, encrypted the vast \nmajority of the company\u2019s systems with Makop ransomware, and performed \u201cFastErase\u201d on the backup tapes. One of \nthe central Active Directory domain controllers was not encrypted, but renamed by the attacker, which left a 4TB file on \nthe OS partition to make it more difficult to remediate the server. Notably, the ransomware actor threatened to delete the \ndecryption key within 24 hours to increase pressure on the client.\nAfter forensics investigation, we found no indicators of data exfiltration, but identified artefacts evidencing the use of \nMimikatz for password extraction. The first threat actor activity on the corporate network was found three days before the \nransomware attack occurred. The threat actor\u2019s initial access vector was via a vulnerable Microsoft Exchange server. The \nexploitation of CVE-2020-0688 alone does not indicate any special abilities of the attacker, but its modus operandi \u2013 such \nas the fast deletion of the tapes \u2013 and its communication behavior indicate a high level of capability.\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "9a1b6419-5a2f-4a09-aabc-c838596e1587": {"__data__": {"id_": "9a1b6419-5a2f-4a09-aabc-c838596e1587", "embedding": null, "metadata": {"page_label": "34", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "34  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nPrintNightmare\nAnother series of vulnerabilities uncovered this year were focused on the Windows print spooler service, allowing for remote \ncode execution and local privilege escalation attacks against servers running the service. A specific version of this vulnerability \nwas given the name PrintNightmare.98\nInitially there was some confusion about which vulnerability \u201cPrintNightmare\u201d actually referenced. CVE-2021-1675 was initially \nthought to be the main vulnerability (which a PoC was briefly made publicly available for, and which Microsoft released  \na patch for);99 however, the patch for this vulnerability did not fix PrintNightmare, which was eventually given the identifier  \n CVE-2021-34527.100\nThe print spooler vulnerability that was being exploited (as well as what system it was running on) would determine the \npotential impact of successful exploitation. The highest impact would be the ability to escalate privileges on a Windows \nDomain Controller Server, allowing attackers full access to all aspects of a company\u2019s infrastructure. To mitigate this, some \ncompanies were disabling the print spooler service on domain controllers. This, however would not fix the vulnerability running \non any unpatched, or configurationally vulnerable Windows client machines. This would allow attackers then to escalate \nprivileges locally from an initial phishing vector to bypass local security controls, and potentially move laterally with greater \nfreedom until they could discover an administrator system and use the vulnerability to escalate privileges and dump their \ncredentials, which would allow them access to the domain controller as well.\nJune and July of 2021 saw the release of a number of advisories and patches from Microsoft relating to vulnerabilities \nexisting in the print spooler service, which if exploited, could grant an escalation of privileges. This, likewise, saw numerous \ndiscussions and code releases from the offensive security community demonstrating that the patches were either ineffective \nat fixing the issues fully, or were easily bypassed, with updates to the relevant open source tools to make those bypasses \ngenerally available \u2013 as was the case with Mimikatz.\nDetection engineering with the print spooler\nPrintNightmare has been integrated into open source offensive security tools such as \nMimikatz and Metasploit, with additional modules for Cobalt Strike. In October 2021, \nQakBot was also seen adopting PrintNightmare for privilege escalation.101\nDetections for malicious activity exploiting it revolved around the \nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows \nx64\\Drivers\\Version-3\\*  registry key where various settings for the printer \ndriver could be found. The default settings for a number of open source tools could be \nsignatured and detections written for them, such as the creation of the key \nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows \nx64\\Drivers\\Version-3\\1234  or HKLM\\SYSTEM\\CurrentControlSet\\Control\\\nPrint\\Environments\\Windows x64\\Drivers\\Version-3\\12345 .\nHowever, threat hunting proves to be a much more difficult task  when these particular \nkey names were not used, due to the sheer number of legitimate printer related \ninstallations or configurations. A better method revolved around tracking the absence or \nexistence of registry values in the \nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows \nx64\\Drivers\\Version-3\\*  \nkey location.\nWhile detecting related malicious activity in network traffic was nontrivial, we found a \nviable solution by looking for a chain of requests and responses, starting with Spoolss, \nthen EnumPrinterDrivers, before multiple AddPrinterDriverEx requests and responses. \nThe resulting chain, along with detection for a buffer overflow response from the target, \nprovided a high confidence detection of successful exploitation.\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "8b375b4f-4137-4197-8721-afc6c32ecaef": {"__data__": {"id_": "8b375b4f-4137-4197-8721-afc6c32ecaef", "embedding": null, "metadata": {"page_label": "35", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "CVE-2021-40444\nIn September 2021, Microsoft released an advisory for a remote code execution (RCE) vulnerability (with identifier CVE-\n2021-40444) which allows a malicious MS Cabinet (.cab) or .inf file to be launched when a malicious document is opened.102 \nWhile the vulnerability still requires the threat actor to phish a victim and convince them to open a malicious document, it \ndoes provide another approach for threat actors to initially execute code on a victim system, and the fact that macros are not \nneeded to exploit the vulnerability might also avoid alerting victims to the malicious activity.\nA document exploiting CVE-2021-40444 embeds a URL in their \u2018document.xml.rels\u2019 file. This is a similar technique to that of \ntemplate injection, but rather than the Word document fetching a remote template, the file attempts to load some HTML. The \nrelevant XML tag in the document is as follows: \n<Relationship Id=\u201drId6\u201d \nType=\u201dhttp://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject\u201d Target=\u201dmhtml:[Target URL]\nx-usc:[Target URL]\u201d TargetMode=\u201dExternal\u201d/> \nA specifically crafted HTML webpage could contain code to exploit CVE-2021-40444 to achieve RCE; and, using that RCE, \nperform a follow-on action, such as downloading and executing a next-stage payload. \nOur analysis of the first observed CVE-2021-40444 documents revealed some infrastructure overlaps with that of ransomware \ngroups; however it was inconclusive whether it was a cyber crime focused threat actor that initially developed and exploited \nthis vulnerability.104\nDetection engineering on CVE-2021-40444\nWhile CVE-2021-40444 exploited Microsoft Office applications that are usually heavily signatured by \ndetection engineers, it produced a particularly unfortunate string of behaviours as far as detection \nis concerned. In most situations, monitoring for Office Applications spawning suspicious processes \nis an incredibly simple and effective means of detecting malicious activity on an endpoint. These \nprocesses usually support the objective of the attacker, and examples of such processes are \npowershell.exe, rundll32.exe or mshta.exe. \nThe exploitation of CVE-2021-40444 suprasses many endpoint detection rules surrounding Microsft \nOffice applications. Upon analyzing the execution chain, it appears to indicate that common EDR \ndetection rules were potentially examined to determine the best possible way of bypassing EDR \nproducts and achieve a stealthy execution of the payload.\nThe first bypass techniques take place when the MS Cabinet (.cab file) is downloaded to disk. The \nCabinet file contains a DLL which is unpacked to a relative location and given a .inf extension. \nMicrosoft Office applications commonly drop files with a .inf extension, so giving the malicious file \nthis extension means the behaviour blends in with normal system activity. The .inf file uses a relative \nreference (..\\<filename>.inf) to ensure that it is written to an unpredictable cache location. Such \nlocations are particularly hard for threat hunters to triage due to the presence of a high number of \ntemporary system files.\nTo become even more evasive of EDR signatures, .cpl:is prepended to the file\u2019s document.URL \nparameter. This simple addition has two intended effects, both of which reduce the chances of \ndetection. First, ActiveX cannot execute .cpl files, so will automatically pass this execution to the \n\u2018control.exe\u2019 process. This results in the Microsoft Application spawning control.exe \u2013 a behaviour \nthat was not commonly monitored prior to this exploit becoming public. Second, the .inf file that \nfollows the .cpl: parameter is immediately passed to rundll32.exe. Although threat hunters usually \nkeep a keen eye on this process, in this instance it features command line arguments that are very \ncommon and highly likely to be \u2018tuned out\u2019 of detection rules. This is of great convenience to the \nattacker as it means their activity might be excluded from existing detection rules.\nFocusing at the start of the attack, we have network signatures that detect the malicious response to \nthe initial .cab file request. On the endpoint, the most straightforward means of detection is to look for \na .cpl: string in the command line of either control.exe or rundll32.exe. We also monitor for artefacts in \nthe registry and files on disk which further indicate the successful exploitation of CVE-2021-40444.35  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "b7b87402-e560-4fe4-8248-147ca9bba3ea": {"__data__": {"id_": "b7b87402-e560-4fe4-8248-147ca9bba3ea", "embedding": null, "metadata": {"page_label": "36", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "Log4Shell/Log4J\nWrapping up the year were several critical vulnerabilities found in the Java-based logging utility Apache Log4j 2.104 The initial \nvulnerability (given the ID CVE-2021-44228) became known as Log4Shell, and allowed for unauthenticated remote code \nexecution on a server running the software.105 This vulnerability was given, and still retains, a CVSS score of 10.0 \u2013 the highest \nrating \u2013 due to the dual factors of Log4j being a popular logging utility used in numerous Java applications, as well as the \nexploit being relatively easy to perform.\nWhile a patch was immediately released for this vulnerability, mass-scanning/mass-exploitation attempts for vulnerable servers \nbegan almost immediately after the vulnerability was announced. It only took two days for advanced persistent threat actors to \nget involved in exploiting these vulnerabilities as well.106 In addition, several new vulnerabilities were spawned from the patches \nrolled out in order to fix CVE-2021-44228. To summarise the other vulnerabilities:\n\u2022  CVE-2021-45046: This  bug exists  in  Apache  Log4j  2.15.0 (the first patch to treat the initial Log4Shell exploit) and  allows  \nan  attacker  to  perform remote code execution in certain non-default configurations\n\u2022  CVE-2021-4104 - This is another remote code execution vulnerability that was found during research of the Log4j software, \nand fortunately only affects Apache Log4j versions before 1.2, which reached end of life in 2015. This vulnerability was \nassessed to likely affect few systems\n\u2022  CVE-2021-45105 - This vulnerability was found in the Log4j version 2.16; an initial hotfix for the CVEs above. It was found \nthat version 2.16 did not protect from this new vulnerability, which is caused by the capability of the Thread Context Map \nto make self-referential lookups, thus leading to uncontrolled recursion and a potential StackOverflowError, crashing the \nprogramme. This would count as a Denial of Service (DOS), and is not related to remote code execution.\nAs with many vulnerabilities/exploits, it can be difficult to detect the actual exploitation attempts, especially as new variants \nare rapidly developed. However, given the wide variety of threat actors exploiting these vulnerabilities, it is inevitable that a \nproportion of them will default to using techniques and tools that are well understood. Having appropriate solutions in place \nsuch as AV/EDR may not always detect the actual exploitation attempt, but can be used to detect and monitor  \nfollow-on activity.\nStrategic web compromise activity and browser 0-days\nWhile we have highlighted above the most high-profile vulnerabilities throughout 2021, it is also worth noting that threat actors \ncontinued to use exploits (in some cases 0-days) as part of lesser known campaigns. \nFor example, strategic web compromises/watering hole attacks had several pieces of research in 2021 highlighting how they \nhave been used to target end users with browser exploits. Victims in parts of Asia were targeted with macOS and iOS exploits \nfor individuals visiting a media website and a political party\u2019s website. In separate campaigns, the North Korea-based threat \nactor that we track as Black Shoggoth (aka APT37, Reaper) targeted visitors to a South Korean news website that focused its \nreporting on North Korea, to deliver the BLUELIGHT remote access trojan.107 108 \nA longer series of campaigns were also detailed in open source research into watering hole attacks against a large number of \nwebsites (mainly government or news organisations related to the Middle East), which have links to a spyware vendor called \nCandiru. 109 110 111 These types of campaigns are noteworthy due to how they can target very specific demographics, with \nusually more advanced initial access vectors. Developing exploits is more time-consuming and costly than a standard phishing \nemail, but makes it more likely that threat actor activity will not be detected by traditional means. \n36  PwC Cyber Threats 2021: A Year in Retrospect - Annex", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "49549e04-599d-4cee-8848-5a9ed57bb961": {"__data__": {"id_": "49549e04-599d-4cee-8848-5a9ed57bb961", "embedding": null, "metadata": {"page_label": "37", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "37  PwC Cyber Threats 2021: A Year in Retrospect - Annex\nAs we highlighted in our 2021 Year in Retrospect report, while \nin some cases threat actors might acquire credentials to \nvictims\u2019 networks by running phishing campaigns, credential \nmarketplaces are playing an increasingly impactful role in the \ncyber criminal ecosystem, providing easier initial access into \nnetworks to ransomware operators and other threat actors.\nThe large number of 0-day disclosures in 2021 \u2013 and the large \nnumber of appliances affected by some of them \u2013 naturally \nresulted in higher volumes of exploitation attempts against \norganisations\u2019 internet-facing servers and appliances both \nbefore and after initial public release. APTs and cyber criminal \ngroups alike were observed performing both targeted as \nwell as mass-scale exploitation of these vulnerabilities (with \nProxyLogon being a key example), very clearly undermining \nthe public perception that APTs only perform highly-tailored \nintrusions, and instead demonstrating the appetite for \nopportunistic widespread access operations.\nDespite this consideration, known vulnerabilities \u2013 such as \nin Virtual Private Network (VPN) appliances \u2013 continue to be \nsuccessfully exploited by threat actors as we highlighted in \nour 2020 Year in Retrospect report. Yet, defence in depth, and \nlogging and monitoring of suspicious activity can help identify \nmalicious activity even ahead of vulnerabilities being publicly \ndisclosed. Detection methods developed for suspicious or \nmalicious behaviour can also prove valuable beyond their \nimmediate use case, and support future rule development.\nSome simple steps you can take include:\n\u2022  Invest in gaining a comprehensive understanding of your \nenvironment and updating your asset inventory. If you \ndon\u2019t know what devices and applications are part of your \nenvironment, you can\u2019t devise appropriate security plans.\n\u2022  Deploy MFA where supported. Whether this is TOTP \nbased, or using a hardware token supporting U2F , or \nWebAuth, this makes abuse of credentials harder for  \nan attacker.\u2022  Enabling logging of accesses and activity on critical \nsystems, where logs are retained, monitored, and \nreviewed.\n\u2022  Enabling antivirus protection (for example Windows \nDefender), and also checking the logs output by the AV to \ncheck for any suspicious files, which can then be triaged \nfurther (e.g., using a collection of YARA rules).\n\u2022  Generic, behavioural, and heuristic detection rules can \nhelp identify even relatively sophisticated attackers as they \nattempt to move through the network. \n\u2022  Empower your defenders to spend time hunting. This is an \nexcellent way of detecting the unknown, and also helps \nyou identify visibility gaps in your environment.\n\u2022  Consider building a threat model against your controls \nenvironment, to better understand how attackers would \ninteract with your controls. This will help you identify key \ncontrols, areas that are in need of improvement, and help \nyou prioritise remediation work.\n\u2022  Implement defence in depth. Organisations shouldn\u2019t rely \non any one of your detection or security layers detecting \nor blocking 100% of all attacks. Layered security \nincreases the probability that you will block or detect \nactivity, and gives you more information for responding  \nto incidents.\n\u2022  Prioritise vulnerability patching based on your individual \nenvironment and critical assets. \nAs public attention on cyber security matters continues \nto grow, focusing on actionable defensive measures, \nplus mitigation and response strategies, ahead of time \nis imperative for organisations across all sectors, though \nthese will of course change for each one. At the same time, \nit is more important than ever for defenders to continue \ncollaborating, sharing, and supporting organisations and \nsociety; focusing on prevention and detection measures; \nas well as incident mitigation and response plans that can \nfrustrate threat actors in their tracks.Conclusion\nIn 2021 we observed threat actors frequently abusing \nvalid credentials and exploiting vulnerabilities for \ninitial access, continuing and increasing a trend from \nprevious years. ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "029b129d-1a8d-4fe7-b188-a2dc7d7235d3": {"__data__": {"id_": "029b129d-1a8d-4fe7-b188-a2dc7d7235d3", "embedding": null, "metadata": {"page_label": "38", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "38  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n1. \u2018Your dream job awaits - just please enable editing\u2019, PwC Threat Intelligence, CTO-TIB-20210916-01A\n2. \u2018Blue Dev 5 - Mysteries of Foreign Affairs\u2019, PwC Threat Intelligence, CTO-TIB-20210527-01A \n3. \u2018ProxyShell Exploitation\u2019, PwC Threat Intelligence, CTO-QRT-20210820-01A\n4. \u2018HAFNIUM exploiting Exchange vulnerabilities\u2019, PwC Threat Intelligence, CTO-QRT-20210303-01A\n5. \u2018Active scanning of CVE-2021-44228\u2019, PwC Threat Intelligence, CTO-QRT-20211210-01A\n6. \u2018Red Djinns Red Flags\u2019, PwC Threat Intelligence, CTO-TIB-20210903-02A \n7. \u2018Scanning the internet for vulnerabilities\u2019, PwC Threat Intelligence, CTO-TIB-20211118-01A\n8. \u2018A Zoom call with White Dev 89\u2019, PwC Threat Intelligence, CTO-TIB-20211118-02A\n9. \u2018Blue Dev 5 - The Roots of Targeting\u2019, PwC Threat Intelligence, CTO-TIB-20210608-01A\n10. \u2018Phishing in the Middle East\u2019 PwC Threat Intelligence, CTO-TIB-20210629-02A\n11. \u2018The Banshee The Flower The Dragon and Prince\u2019, PwC Threat Intelligence, CTO-TIB-20210508-01A \n12. \u2018The [redacted] sheds light on a campaign\u2019, PwC Threat Intelligence, CTO-TIB-20210712-01A\n13. \u2018Eat, Sleep, Liderc, Repeat\u2019, PwC Threat Intelligence,  CTO-TIB-20210730-01A\n14. \u2018Babuk - A new kid on the block\u2019, PwC Threat Intelligence, CTO-TIB-20210201-02A\n15. \u2018Well its been a MirrorBlast\u2019, PwC Threat Intelligence, CTO-TIB-20211025-01A\n16. \u2018All LNKs lead back to Black Dev 1 Part 1\u2019, PwC Threat Intelligence, CTO-TIB-20210408-01A \n17. \u2018Colder than IcedID\u2019, PwC Threat Intelligence, CTO-TIB-20210511-01A\n18. \u2018An interstellar kitten transforms into a jaguar\u2019, PwC Threat Intelligence,  CTO-TIB-20211027-01A \n19. \u2018Introducing Red Dev 14\u2019, PwC Threat Intelligence, CTO-TIB-20210412-01A\n20. \u2018Exploring Blue Odin\u2019, PwC Threat Intelligence, CTO-TIB-20210308-01A\n21. \u2018Blue Otso\u2019s Office Expertise\u2019, PwC Threat Intelligence, CTO-TIB-20210122-02A\n22. \u2018Capital injection\u2019, PwC Threat Intelligence, CTO-TIB-20210630-03A\n23. \u2018Chasing Shadows\u2019, PwC Threat Intelligence, CTO-TIB-20211021-01A \n24. \u2018Chasing Shadows: A deep dive into the latest obfuscation methods being used by ShadowPad\u2019, PwC: Adam Prescott, https://www.pwc.co.uk/issues/cyber-security-\nservices/research/chasing-shadows.html (8th December 2021)\n25. \u2018You\u2019re not Shikata Ga Nai believe this\u2019, PwC Threat Intelligence, CTO-TIB-20211102-02A\n26. \u2018Hiding in plain sight\u2019, PwC Threat Intelligence, CTO-TIB-20211126-01A\n27. \u2018Analysis of ObliqueRAT\u2019, PwC Threat Intelligence, CTO-TIB-20210330-01A\n28. \u2018Nothing else BlackMatters\u2019, PwC Threat Intelligence, CTO-TIB-20211209-01A\n29. \u2018The Banshee The Flower The Dragon and Prince\u2019, PwC Threat Intelligence, CTO-TIB-20210508-01A \n30. \u2018Nothing else BlackMatters\u2019, PwC Threat Intelligence, CTO-TIB-20211209-01A\n31. \u2018Causing more Grief\u2019, PwC Threat Intelligence, CTO-TIB-20211028-01A\n32. \u2018Orange Athos has BADNEWS for its adversaries\u2019, PwC Threat Intelligence, CTO-TIB-20210204-02A\n33. \u2018The Banshee The Flower The Dragon and Prince\u2019, PwC Threat Intelligence, CTO-TIB-20210508-01A\n34. \u2018You\u2019re not Shikata Ga Nai believe this\u2019, PwC Threat Intelligence, CTO-TIB-20211102-02A\n35. \u2018Learning to ChaCha with Red Kelpie\u2019, PwC Threat Intelligence, CTO-TIB-20210624-02A \n36. \u2018Eat, Sleep, Liderc, Repeat\u2019, PwC Threat Intelligence, CTO-TIB-20210730-01A\n37. \u2018All LNKs lead back to Black Dev 1 Part 1\u2019, PwC Threat Intelligence, CTO-TIB-20210408-01A\n38. \u2018The Banshee, the Flower, the Dragon, and Prince\u2019, PwC Threat Intelligence, CTO-TIB-20210805-01A\n39. \u2018Of Gh0sts and Golang\u2019, PwC Threat Intelligence, CTO-TIB-20211011-01A\n40. \u2018The mysterious case of the KeyBoy samples\u2019, PwC Threat Intelligence, CTO-TIB-20210614-01A\n41. \u2018Of Gh0sts and Golang\u2019, PwC Threat Intelligence, CTO-TIB-20211011-01A \n42. \u2018Red Djinns spider web\u2019, PwC Threat Intelligence, CTO-TIB-20211202-01A\n43. \u2018Shades of Bluelight\u2019, PwC Threat Intelligence, CTO-TIB-20210910-01A\n44. \u2018Looking past the clouds, is that Zekapab\u2019, PwC Threat Intelligence, CTO-TIB-20211012-01A\n45. \u2018How to be a ransomware operator\u2019, PwC Threat Intelligence, CTO-TIB-20210827-01A\n46. \u2018Dropbox RAT targets Afghan NSC\u2019, PwC Threat Intelligence, CTO-TIB-20210505-01A\n47. \u2018Shades of Bluelight\u2019, PwC Threat Intelligence, CTO-TIB-20210910-01A \n48. \u2018Exploring Blue Odin\u2019, PwC Threat Intelligence, CTO-TIB-20210308-01A\n49. \u2018Red Djinns Red Flags\u2019, PwC Threat Intelligence,  CTO-TIB-20210903-02B\n50. \u2018Red Dev Redemption\u2019, PwC Threat Intelligence, CTO-TIB-20210202-01A \n51. \u2018Withdrawal symptoms\u2019, PwC Threat Intelligence, CTO-TIB-20210831-01A\n52. \u2018Who is Black Alicanto hiring\u2019, PwC Threat Intelligence, CTO-TIB-20210913-01A\n53. \u2018Threats under the Spotlight November 2021\u2019, PwC Threat Intelligence, CTO-TUS-20211203-01A Endnotes", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "159a0fbe-c5b2-4086-9be0-39aa3be7dd80": {"__data__": {"id_": "159a0fbe-c5b2-4086-9be0-39aa3be7dd80", "embedding": null, "metadata": {"page_label": "39", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "39  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n54.  \u2018Lockbit 2.0\u2019, PwC Threat Intelligence, CTO-TIB-20211027-02A\n55.  \u2018Eat, Sleep, Liderc, Repeat\u2019, PwC Threat Intelligence, CTO-TIB-20210730-01A\n56.  \u2018Qakbot Technical Analysis\u2019, Kaspersky: Anton Kuzmenko, Oleg Kupreev, Haim Zigel, https://securelist.com/qakbot-technical-analysis/103931/ (2nd September 2021) \n57.  \u2018Internet Crime Report 2020\u2019, FBI Internet Crime Complaint Center (IC3), https://www.ic3.gov/Media/PDF/AnnualReport/2020_IC3Report.pdf (2020) \n58.  \u2018Valid Accounts\u2019, MITRE, https://attack.mitre.org/techniques/T1078/\n59.  \u2018Input Capture: Web Portal Capture\u2019, MITRE, https://attack.mitre.org/techniques/T1056/003/\n60.  \u2018Suspected Russian Activity Targeting Government and Business Entities Around the Globe\u2019, Mandiant: Luke Jenkins, Sarah Hawley, Parnian Najafi, Doug Bienstock, \nhttps://www.mandiant.com/resources/russian-targeting-gov-business (6th December 2021) \n61.  \u2018Nothing Else BlackMatters\u2019, PwC Threat Intelligence, CTO-TIB-20211209-01A\n62.  \u2018Valid Accounts\u2019, MITRE, https://attack.mitre.org/techniques/T1078/ \n63.  \u2018A unique peek at 13 weeks of leaks - Part 1\u2019, PwC Threat Intelligence, CTO-SIB-20211209-01A \n64.  https://ora.ox.ac.uk/objects/uuid:6d1260fd-b8ee-4a11-8a5f-e7708d543651\n65.  \u2018Tracking GhostNet: investigating a cyber espionage network\u2019, Greg Walton et al, https://ora.ox.ac.uk/objects/uuid:6d1260fd-b8ee-4a11-8a5f-e7708d543651 (2009)\n66.  \u2018Of Gh0sts and Golang\u2019, PwC Threat Intelligence, CTO-TIB-20211011-01A\n67.  \u2018Red Djinn\u2019s Red Flags\u2019, PwC Cyber Threat Intelligence, CTO-TIB-20210903-02A \n68.  \u20188t to PIVY Red Dev 17s recipe for compromise\u2019, PwC Threat Intelligence, CTO-TIB-20210428-02A\n69.  \u2018Red Dev 17 PIVY Pivots\u2019, PwC Threat Intelligence, CTO-TIB-20211021-02A\n70.  \u2018A41APT case\u2019, Japan Security Analyst Conference 2021, January 2021, https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwayanagishita_en.pdf\n71. \u2018The mysterious case of the KeyBoy samples\u2019, PwC Threat Intelligence, CTO-TIB-20210614-01A\n72. \u2018You\u2019re not Shikata Ga Nai believe this\u2019, PwC Threat Intelligence, CTO-TIB-20211102-02A\n73. \u2018Phishing in the Middle East\u2019, PwC Threat Intelligence, CTO-TIB-20210629-02A\n74. \u2018For those about to ROKRAT, we salute you\u2019, PwC Threat Intelligence, CTO-TIB-20211208-01A (or swap with 75)\n75. \u2018Shades of Bluelight\u2019, PwC Threat Intelligence, CTO-TIB-20210910-01A (or swap with 74)\n76. Rclone, \u2018Rclone\u2019, https://rclone.org\n77. \u2018How to be a ransomware operator\u2019, PwC Threat Intelligence, CTO-TIB-20210827-01A\n78. F-Secure, \u2018C3\u2019, https://github.com/FSecureLABS/C3\n79. \u2018Dropbox RAT targets Afghanistan NSC\u2019, PwC Threat Intelligence, CTO-TIB-20210505-01A\n80. \u2018IndigoZebra APT continues to attack Central Asia with evolving tools\u2019, CheckPoint, https://research.checkpoint.com/2021/indigozebra-apt-continues-to-attack-central-\nasia-with-evolving-tools/ (1st July 2021) \n81. \u2018A41APT case\u2019, Japan Security Analyst Conference 2021, January 2021, https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwayanagishita_en.pdf\n82.  \u2018APT10: sophisticated multi-layered loader Ecipekac discovered in A41APT campaign\u2019, Kaspersky, https://securelist.com/apt10-sophisticated-multi-layered-loader-\necipekac-discovered-in-a41apt-campaign/101519/ (30th March 2021) \n83. Kaspersky, \u2018SAS 2021: Learning to ChaCha with APT41\u2019, https://securelist.com/webinars/sas-2021-learning-to-chacha-with-apt41/\n84. GitHub, \u2018TheSAS2021-Red-Kelpie\u2019, https://github.com/PwCUK-CTO/TheSAS2021-Red-Kelpie\n85. \u20182021 has broken the record for 0-day hacking attacks\u2019, MIT Technology Review: Patrick Howell O\u2019Neill, https://www.technologyreview.com/2021/09/23/1036140/2021-\nrecord-0-day-hacks-reasons/ (23rd September 2021) \n86. \u2018HAFNIUM exploiting Exchange vulnerabilities\u2019, PwC Threat Intelligence, CTO-QRT-20210303-01A\n87. \u2018HAFNIUM targeting Exchange Servers with 0-day exploits\u2019, Microsoft, https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ (2nd \nMarch 2021)\n88. \u2018Operation Exchange Marauder: Active Exploitation of Multiple 0-day Microsoft Exchange Vulnerabilities\u2019, Volexity: Josh Grunzweig, Matthew Meltzer, Sean Koessel, \nSteven Adair, Thomas Lancaster, https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-0-day-vulnerabilities/ (2nd March 2021)\n89. HAFNIUM exploiting Exchange vulnerabilities\u2019, PwC Threat Intelligence, CTO-QRT-20210303-01A\n90. \u2018Introducing Red Dev 14\u2019, PwC Threat Intelligence, CTO-TIB-20210412-01A\n91. \u2018Red Djinns spider web\u2019, PwC Threat Intelligence, CTO-TIB-20211202-01A \n92. \u2018DearCry Ransomware\u2019, PwC Threat Intelligence, CTO-QRT-20210315-01A\n93. \u2018FROM PWN2OWN 2021: A NEW ATTACK SURFACE ON MICROSOFT EXCHANGE - PROXYSHELL!\u2019, Zero Day Initiative, https://www.zerodayinitiative.com/\nblog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell (18th August 2021)\n94. \u2018Microsoft Exchange servers are getting hacked via ProxyShell exploits\u2019, Bleeping Computer, https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-\nservers-are-getting-hacked-via-proxyshell-exploits/ (12th August 2021)\n95. \u2018ProxyShell Exploitation\u2019, PwC Threat Intelligence, CTO-QRT-20210820-01A \n96. MITRE, \u2018Initial Access\u2019, https://attack.mitre.org/tactics/TA0001/\n97. Microsoft, \u2018Released: March 2021 Exchange Server Security Updates\u2019,  \nhttps://techcommunity.microsoft.com/t5/exchange-team-blog/released-march-2021-exchange-server-security-updates/ba-p/2175901 \n98. \u2018PrintNightmare\u2019, PwC Threat Intelligence, CTO-QRT-20210706-01A\n99. Microsoft, \u2018CVE-2021-1675\u2019, https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675\n100. Microsoft, \u2018CVE-2021-34527\u2019, https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527 \n101. \u2018A Duck Nightmare\u2019, Cynet, https://www.cynet.com/attack-techniques-hands-on/quakbot-strikes-with-quaknightmare-exploitation/#_Technical_Analysis:_\nPrintNightmare (11th November 2021) \n102. CVE-2021-40444, \u2018PwC Threat Intelligence\u2019, CTO-QRT-20210908-01A\n103. \u2018Untangling the Spider Web\u2019, RiskIQ, https://www.riskiq.com/blog/external-threat-management/wizard-spider-windows-0day-exploit/ (15th September 2021) \n104. \u2018Active scanning of CVE-2021-44228\u2019, PwC Threat Intelligence, CTO-QRT-20211210-01A\n105. Log4J, \u2018Apache Log4j Security Vulnerabilities\u2019, https://logging.apache.org/log4j/2.x/security.html \n106. \u2018Guidance for preventing, detecting, and hunting for CVE-2021-44228 Log4j 2 exploitation\u2019, Microsoft, https://www.microsoft.com/security/blog/2021/12/11/guidance-\nfor-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/ (11th December 2021)\n107. \u2018Shades of Bluelight\u2019, PwC Threat Intelligence, CTO-TIB-20210910-01A\n108. \u2018North Korean APT InkySquid Infects Victims Using Browser Exploits\u2019, Volexity, https://www.volexity.com/blog/2021/08/17/north-korean-apt-inkysquid-infects-victims-\nusing-browser-exploits/ (17th August 2021) ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "a3ae2452-8056-406c-9b6c-f376ab8269e3": {"__data__": {"id_": "a3ae2452-8056-406c-9b6c-f376ab8269e3", "embedding": null, "metadata": {"page_label": "40", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "40  PwC Cyber Threats 2021: A Year in Retrospect - Annex\n109. \u2018Hooking Candiru\u2019, The Citizen Lab, https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/ (15th July 2021)\n110. \u2018How we protect users from 0-day attacks\u2019, Google Threat Analysis Group, https://blog.google/threat-analysis-group/how-we-protect-users-0-day-attacks/ (14th July \n2021)\n111. \u2018Strategic web compromises in the Middle East with a pinch of Candiru\u2019, ESET, https://www.welivesecurity.com/2021/11/16/strategic-web-compromises-middle-east-\npinch-candiru/ (16th November 2021) ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}, "a5fddd79-8b67-470d-a641-dd694e1349b3": {"__data__": {"id_": "a5fddd79-8b67-470d-a641-dd694e1349b3", "embedding": null, "metadata": {"page_label": "41", "file_name": "yir-cyber-threats-annex-download.pdf", "file_path": "file_storage/yir-cyber-threats-annex-download.pdf", "file_type": "application/pdf", "file_size": 15134370, "creation_date": "2024-08-17", "last_modified_date": "2024-08-17"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {}, "text": "pwc.com/cyber-security\nThis publication has been prepared for general guidance on matters of interest only, and does not constitute professional \nadvice. You should not act upon the information contained in this publication without obtaining specific professional advice. No \nrepresentation or warranty (express or implied) is given as to the accuracy or completeness of the information contained in this \npublication, and, to the extent permitted by law, PricewaterhouseCoopers LLP , its members, employees, and agents do not accept \nor assume any liability, responsibility, or duty of care for any consequences of you or anyone else acting, or refraining to act, in \nreliance on the information contained in this publication or for any decision based on it.\n\u00a9 2022 PwC. All rights reserved. PwC refers to the PwC network and/or one or more of its member firms, each of which is a \nseparate legal entity. Please see www.pwc.com/structure for further details.  ", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "Document"}, "__type__": "4"}}, "docstore/metadata": {"741e6a5b-0e7f-4faa-903a-7a06804f95a2": {"doc_hash": "cf279126ddd68463d8c63d99e0497a1019a955f4cc5bd3dedd982d441056cab0"}, "19df8129-33e6-4812-90e1-2a5e7468dd06": {"doc_hash": "5a7ac113bbe38d2827e60f3f67af500fb81472bc0cdcbdc6ba82e125d58de0b5"}, "ca0e28c5-eeeb-4c22-993c-f27755980db3": {"doc_hash": "941c833132ac9eb8aad58df5a853e4218317e4f3c427a67ebf5d24612783d891"}, "31a54b92-50fb-497c-9e16-4a5cd57405b7": {"doc_hash": "75fecae4de8cd8ccb2d3399fbd13bc1c13a3bcb495558647156e805297bc333d"}, "dda01e93-233e-42d6-b0bc-02119e238ab5": {"doc_hash": "a5560bef143b4765f4e6e68094c60b05c0a84eda98d7d4c127c05cdcdacdc3e1"}, "4a790494-2857-408c-9cea-2b5ac5040323": {"doc_hash": "c00bd75bf5f42eab243e0afcb7ef2571fff8d7bc5f3fd68ca2e6cc94436ad640"}, "4f2613fb-1197-458c-bd7f-516bd4393a23": {"doc_hash": "bf1878b533f257f0cceaa187ce80093af5c9c4821b4f5c03d5809e79856458bf"}, "771a26b7-2fda-4235-b013-19fa89de2eb5": {"doc_hash": "977c83b3add126a4cae48b42af5db5ca9d218cd67bc725a7dc0aa2068973f9a7"}, "74690be7-c35e-4f22-ba9f-eb3a4138a01a": {"doc_hash": "8d011187b4ee069a2304fba89b4f3ef1bcae3ebf77cf7a24546ffa8073ad1f5d"}, "8161e78f-255a-4955-b567-bb228bdd2b1d": {"doc_hash": "ec00266e0be2cc5021e8b22f7471b56a4576087561933efa72073852ba3ee86a"}, "47c34c78-9412-47ab-b400-8c8278c2b0a7": {"doc_hash": "d2404ff699d5478483e42f70cbfbf4abde07c9eb0c56474296a2a800c128dc7f"}, "512c5a53-38cf-4b63-93e2-7e622cfaf53a": {"doc_hash": "17de61e2346f0dd4c91ca199eb91acd912cfbe17930d5313d28cc803987d5256"}, "5277dfdd-93b4-47de-a24a-2a5f2217e868": {"doc_hash": "e41ec30a1abdef6fd447dd7a4a3245a03ce4d958827f61a9806858514d739c7c"}, "6b8cd031-0466-4a93-a105-a689bf221b34": {"doc_hash": "524935f6f3ccd77ba12ebee8c994fb8d96346f2c6b2dde893537ec4d84bb9f32"}, "d0979b92-4d92-4e39-b882-c6cf6301041a": {"doc_hash": "76beef9ac44ebef7ba762abb3e9ed215553e84c3a6818c325491de5c508bf7c5"}, "7c2672cd-8816-4807-88d4-159ce55fe4c9": {"doc_hash": "cc2bdfdca88f6b3fd41f68f2ae83d5a3483189709554184fd09803e927195b3b"}, "82d67016-69e6-43a3-8b67-05bdb36c8839": {"doc_hash": "f1b9fa6c03e4454657910bae49c4cff0dbe23c6760eb4d3dd68dabf61ee4bb82"}, "3d236b9d-0c10-4c37-be7b-608dd421cff4": {"doc_hash": "e0efbca48e6e77f1ef200cab5eccc1506cc65bb0f437398b0b582cbe405f778d"}, "042e43d3-2dca-4676-abca-19540f6bed63": {"doc_hash": "980c09f4e7d78f87bc444fb45a6b8928d02cbd572ed6d51f0ac4b2344e0605b0"}, "56fb0f90-ef60-4f9b-a8db-e386e4902253": {"doc_hash": "79420097bda7586c549599a077200c39b3e58e5d2f34e746437e956564a622a2"}, "98d33c75-784c-4d61-b963-12ab52f22037": {"doc_hash": "8774ff14d912717fe6240d82e3bb5e954d7127e7d9595bfbd0c84fdd6b4aa7d7"}, "7479042d-2471-4556-9ffd-05dd9ab68a16": {"doc_hash": "668046afee30ca52947ada4226565a9c5c161f1df429334d899bcbad34bf4165"}, "eedc83f5-dea1-410c-af93-3a4de557c3f5": {"doc_hash": "c97140fe767ed1ad01e24c870227608a396e09f3ca01573e4aa2ebdd6fb67c53"}, "a9565152-f6d6-4c96-9708-94ff8a79bfaa": {"doc_hash": "8c4c790ec1cd49e7369dfd2913757a8ef7c9e679eedead987f21a2035842648d"}, "577416b3-168c-42b0-8d0f-372ac4c67eef": {"doc_hash": "28cbcea284fe3c4f09e75ba459d71e9e989933e35be874e882dca61592edcb06"}, "99b84caf-544a-4a68-a225-400bc699b278": {"doc_hash": "b181a39a9fcc288ec6b9bcb3494017534f10fa9ce9b31c6710bf6757e459bc2b"}, "e5abe010-91ab-436a-990c-3a899afb13b6": {"doc_hash": "34cf5080d9523cd333239e3c1754a2f5272f66aa08b1f556a41544e924b814ed"}, "f6f3525b-ea12-4107-8383-9926ce031e79": {"doc_hash": "21aed0d31fc19fc74ac8309415607996d65c8440391330c007c975bd255010b9"}, "46401197-c835-407d-aed8-6c49e4cbcd22": {"doc_hash": "24ae971f650787e43413d371b0147e262e77d113679df18269bfe505f1880e74"}, "759bea93-cf64-4860-ad69-809a5a1cec3f": {"doc_hash": "4f73dec19896a976b8f3be790ad24784b5793ccac7ddcf0b429039985d848605"}, "520df2cd-13cf-41fc-a730-ea3e19884054": {"doc_hash": "35c75295fbae9dae2556d1033a04b15703f0f52df898dc15f9b826908bb2b331"}, "a9f04e8a-c86b-462a-b8b7-09af667d1e33": {"doc_hash": "702371815d688d5e5a15cfd9d8995c6842a0767d31df5ae56398e7fc1c54abf4"}, "80d746f2-55fa-4577-973a-deb3d5a69abd": {"doc_hash": "d4e265d154878df4c89b7c0484eb3dfe5949b2c93df47811d69b8717ec5c6752"}, "9a1b6419-5a2f-4a09-aabc-c838596e1587": {"doc_hash": "e3e3560d9bb125932e2608503f0c0a11dba62223bb0033aae2ae5a341968af07"}, "8b375b4f-4137-4197-8721-afc6c32ecaef": {"doc_hash": "153f13b753805ce06a733236cf4c2399c8289c2a400760349ee25a3485c9526b"}, "b7b87402-e560-4fe4-8248-147ca9bba3ea": {"doc_hash": "ccffd10bb564e32b66e7c54fc7fe7bf4fcc0c6f9fbcea81f9a85df74fc7c646f"}, "49549e04-599d-4cee-8848-5a9ed57bb961": {"doc_hash": "e76b2b256aad09aaa25c843910cec3074e2069de26fe6aab4e37df89242223b4"}, "029b129d-1a8d-4fe7-b188-a2dc7d7235d3": {"doc_hash": "dbd561cf3d843d9fa34c1dbb75c7ac5e060cb4b65a2f72557d4f49236a0b804a"}, "159a0fbe-c5b2-4086-9be0-39aa3be7dd80": {"doc_hash": "2a5df1376848beb7f9daedf4bdae8cbd71cf87689338a1db945f65ff1787c64b"}, "a3ae2452-8056-406c-9b6c-f376ab8269e3": {"doc_hash": "ce9f9c8a626be85fa67473c44dd10a879afe30a66b569373f7c775433a041aef"}, "a5fddd79-8b67-470d-a641-dd694e1349b3": {"doc_hash": "35a04d4e259774465af4644c1b6443182cc28600b0d356255f704d695c163d4e"}}}